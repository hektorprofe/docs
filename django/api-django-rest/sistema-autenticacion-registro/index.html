<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
    
    
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Sistema de autenticación y registro de usuarios para nuestra API con Django Rest Framework.">
      
      <link rel="canonical" href="https://hektorprofe.github.io/docs/django/api-django-rest/sistema-autenticacion-registro/">
      
        <meta name="author" content="Héctor Costa Guzman">
      
      <link rel="shortcut icon" href="/favicon.ico">
    
    
      
        <title>Sistema de autenticación y registro de usuarios | Curso de Django Rest Framework | Hektor Profe</title>
      
    
    <link rel="stylesheet"
          href="../../../assets/stylesheets/application.2.css">
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet"
              href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    
    <link rel="stylesheet"
          href="https://hektorprofe.github.io/docs/assets/stylesheets/tingle.min.css">
    <style>
@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("https://hektorprofe.github.io/docs/assets/fonts/specimen/MaterialIcons-Regular.woff2") format("woff2"),url("https://hektorprofe.github.io/docs/assets/fonts/specimen/MaterialIcons-Regular.woff") format("woff"),url("https://hektorprofe.github.io/docs/assets/fonts/specimen/MaterialIcons-Regular.ttf") format("truetype")}
[data-md-color-primary="grey"] .md-header { background-color: #191A1D }
[data-md-color-primary="grey"] .md-tabs { background-color: #222831 }
.md-footer-nav { background-color: #222831; }
.md-footer-meta { background-color: #191A1D }
html [data-md-color-primary="grey"] .md-nav--primary .md-nav__title--site { background-color: #191A1D; }
.mini{ display: none; } .maxi{ display: block; }
.embed-container { position: relative; padding-bottom: 56.25%;height: 0; overflow: hidden; max-width: 100%; height: auto; margin-bottom: 0; } 
.embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.md-nav__link:focus, .md-nav__link:hover { color: #018dc5; }
.headerlink{ color: #018dc5 !important; }
.md-footer-links__highlight a{ color: #777 !important; }
.md-footer-links__highlight a:hover{ color: #ddd !important; }
.visible{ display: inherit !important; }
/*.md-tabs { display: none !important; }*/
.nav__btn, .nav__logo{ transition: 0.3s; }
.nav__btn:hover{ color: #aaa; }
.nav__logo:hover{ opacity:.7; }
.nav__logo {max-width: 225px !important; }
img:not([src]){visibility:hidden;}
img.click{opacity: 0.96;box-shadow:rgb(79, 82, 92) -4px 4px}
img.click:hover{opacity: 1;box-shadow:rgb(10, 172, 237) -4px 4px}
.button { background-color: #36bf2d; border: none; color: white !important; padding: 20px 0px; text-align: center; text-decoration: none; display: block; font-size: 97%; width: 100%; font-weight: bold;}
.button:hover { background-color: #4CAF50; color: white; }
.animated.delay-1dot5s {animation-delay: 1.5s;}
.md-icon--search { display:inline-block!important}
a.headerlink{ display: none !important; }
small.edited { display: block; text-align: right; }
#cookie-bar { padding: 1.8rem 1.25rem !important; background: #191A1D  !important; box-shadow:rgba(0, 0, 0, 0.2) 4px 4px 8px 8px; }
#cookie-bar-prompt-logo{ display: none !important; }
div.my-img{text-align:center;margin-top:20px}
@media (max-width: 76.1875em){ .mini{ display: block; } .maxi{ display: none;} /*.md-nav__link[for="nav-1"] { display: none; }*/ }
@media (min-width: 1599.9px){ .md-header-nav__button.md-logo img { height: 37.5px !important; width: 220px; } }
@media (min-width: 1999.9px){ .md-header-nav__button.md-logo img { height: 40px !important; width: 240px; } }
/* Rectificación footer en paginas pequeñas de altura */
@media (max-width: 1599.8px){ .md-container {height: calc(100% - 48px)} }
@media (min-width: 1599.9px){ .md-container {height: calc(100% - 53px)} }
@media (min-width: 1999.9px){ .md-container {height: calc(100% - 58px)} }
@media only screen and (max-width: 959.9px) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 960px) and (max-width: 76.1875em) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 76.1875em) { .nav__logo { display: none !important; } } 
@media only screen and (max-width: 76.1875em) { .md-sidebar--primary { left: -26.2rem;; width: 26.2rem; }  [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(26.2rem); transform: translateX(26.2rem); } [dir="rtl"] [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(-26.2rem); transform: translateX(-26.2rem); } }
@media (min-width: 1219.9px){ #home__btn { display: none !important; } #cursos__btn{ color: white !important; } [data-md-color-primary="grey"] .md-nav__link--active{ color: rgba(0, 0, 0, 0.87); text-decoration: underline !important; } }
@media (min-width: 467.9px){ #discord__btn{ display: inline-block !important; } }
@media only screen and (min-width: 60em){ .md-search__input { background-color: rgb(53, 54, 56); } .md-search__input:hover { background-color: rgb(84, 87, 93); color: white; }}
@media (max-width: 1219.9px){ .md-header-nav__title{ padding: 0 1rem; } .nav__btn {display:none;} }
@media (max-width: 875.9px){ #cookie-bar-button{ margin-top: 20px !important; }}
@media (max-width: 719.9px){ #cookie-bar { padding: 3.25rem 1.25rem; }}
@media (max-width: 512.9px){ #cookie-bar { padding: 2rem 1.25rem; }}

.tingle-modal { font-size:18px !important;}
.tingle-modal-box{ width: 80%; max-width: 1100px; }
.tingle-btn--danger{ background: darkorange !important; }
.tingle-modal-box__content { padding: 3rem 2rem 3rem 3rem;}
@media (max-width: 540px){ .tingle-modal-box{ width: auto; } }
@media (max-width: 849px){ #supermodal{ grid-template-columns:100% !important; }}

.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 275px - 60px)}
@media (max-width: 1999.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 246px - 60px);margin-right:-1px;}}
@media (max-width: 1599.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 222px - 60px)}}

    </style>
  </head>
  
    
    
    <body dir="ltr"
          data-md-color-primary="grey"
          data-md-color-accent="grey">
    
      <input class="md-toggle"
             data-md-toggle="drawer"
             type="checkbox"
             id="__drawer"
             autocomplete="off">
      <input class="md-toggle"
             data-md-toggle="search"
             type="checkbox"
             id="__search"
             autocomplete="off">
      <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
      
        <a href="#sistema-de-autenticacion-y-registro-en-drf"
           tabindex="1"
           class="md-skip">Saltar a contenido</a>
      
      
        <header class="md-header"
        data-md-component="header"
        style="position: inherit !important">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://hektorprofe.github.io/docs/"
           title="Archivo - Archivo de Hektor Profe Docs"
           class="md-header-nav__button md-logo"
           style="font-size: 0px">
          <img src="https://hektorprofe.github.io/docs/assets/images/logo.png"
               width="200px"
               height="35px"
               style="margin-top: -5px"
               alt="Hektor Profe"
               title="Hektor Profe" />
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title"
             data-md-component="title"
             style="text-align: right">
          <a class="nav__btn"
             href="https://hektorprofe.github.io/docs/"
             style="margin-left:1.4em"
             title="Buscador de documentos">Buscador</a>
          <a href="https://hektorprofe.github.io/docs/">
            <img class="nav__logo"
                 src="https://hektorprofe.github.io/docs/assets/images/logo.png"
                 width="200px"
                 height="35px"
                 style="margin: 6px auto 0"
                 alt="Hektor Profe"
                 title="Hektor Profe" />
          </a>
        </div>
        <style>
          .md-sidebar[data-md-state="lock"] {
            top: 0rem !important;
          }
          .md-tabs {
            display: none !important;
          }
          .hde {
            display: inline-block;
          }
          .admonition.note > .superfences-tabs > label:hover,
          .headerlink {
            color: #018dc5 !important;
          }
          .admonition.info {
            font-size: 100%;
          }
          .admonition.info label {
            font-size: 91%;
          }
          .admonition.note > .admonition-title {
            display: none;
          }
          .image {
            text-align: center;
            margin-top: 25px;
          }
          .contenedor_youtube {
            position: relative !important;
            padding-bottom: 56.25% !important; /*panorámico*/
            padding-top: 0px !important;
            height: 0 !important;
            margin-top: -20px;
            margin-bottom: 25px;
          }
          .contenedor_youtube iframe {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
          }
        </style>
      </div>
    </div>
  </nav>
</header>
      
      <div class="md-container" style="padding-top: 0px !important;">
        
          
        
        
          

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list" id="top__tabs">
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
      </ul>
    </div>
</nav>
        
        <main class="md-main">
          <div class="md-main__inner md-grid"
               data-md-component="container"
               style="padding-top: 8px !important">
            
              
                <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                  <div class="md-sidebar__scrollwrap" id="md__sidebar__scroll">
                    <div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title" for="__drawer" style="padding:0 !important;max-height:5.5rem;"></label>
  
  <ul class="md-nav__list" id="main__list" data-md-scrollfix>
    
      
    
      
    
      
    
        <!-- comprobación extra -->
         
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Apuntes de Django
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Apuntes de Django
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../../" title="Índice del archivo" class="md-nav__link">
      Índice del archivo
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Proyecto Web Personal
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Proyecto Web Personal
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/" title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/creando-proyecto/" title="Creando el proyecto" class="md-nav__link">
      Creando el proyecto
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/configurando-proyecto/" title="Configurando el proyecto" class="md-nav__link">
      Configurando el proyecto
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/app-core-vistas/" title="App 1 [Core] Vistas" class="md-nav__link">
      App 1 [Core] Vistas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/extendiendo-app-core/" title="Extendiendo la App [Core]" class="md-nav__link">
      Extendiendo la App [Core]
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/paginas-portafolio-contacto/" title="Páginas portafolio y contacto" class="md-nav__link">
      Páginas portafolio y contacto
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/introduccion-plantillas-templates/" title="Introducción a los templates" class="md-nav__link">
      Introducción a los templates
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/templates-about-portfolio-contact/" title="Templates about y portfolio" class="md-nav__link">
      Templates about y portfolio
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/herencia-plantillas-templates/" title="Herencia en las plantillas" class="md-nav__link">
      Herencia en las plantillas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/adaptar-plantillas-herencia/" title="Adaptar plantillas y herencia" class="md-nav__link">
      Adaptar plantillas y herencia
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/template-tag-url/" title="El template tag url" class="md-nav__link">
      El template tag url
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/uniendo-frontend-backend/" title="Uniendo frontend y backend" class="md-nav__link">
      Uniendo frontend y backend
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/creando-cabecera-dinamica/" title="Creando cabecera dinámica" class="md-nav__link">
      Creando cabecera dinámica
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/adaptar-demas-templates/" title="Adaptar los demás templates" class="md-nav__link">
      Adaptar los demás templates
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/app-portfolio-modelos/" title="App 2 [Portfolio] Modelos" class="md-nav__link">
      App 2 [Portfolio] Modelos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/panel-administrador/" title="Panel de administrador" class="md-nav__link">
      Panel de administrador
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/personalizando-panel-administrador-parte-1/" title="Personalizando el admin (1)" class="md-nav__link">
      Personalizando el admin (1)
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/patron-mvt-modelo-vista-template/" title="Patrón MVC" class="md-nav__link">
      Patrón MVC
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-personal/anadir-enlace-proyectos/" title="Añadir enlace a los proyectos" class="md-nav__link">
      Añadir enlace a los proyectos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
            
            
            


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Proyecto Web Empresarial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Proyecto Web Empresarial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/" title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/preparar-app-core/" title="Preparar la app [Core]" class="md-nav__link">
      Preparar la app [Core]
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/organizar-mejor-nuestras-urls/" title="Organizando nuestras URLs" class="md-nav__link">
      Organizando nuestras URLs
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/fusion-frontend-y-backend/" title="Fusión frontend y backend" class="md-nav__link">
      Fusión frontend y backend
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/resaltar-seccion-actual/" title="Resaltando la sección actual" class="md-nav__link">
      Resaltando la sección actual
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/app-services-modelo-admin/" title="App 3 [Services] Modelos" class="md-nav__link">
      App 3 [Services] Modelos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/app-services-vista-template/" title="App 3 [Services] Vistas" class="md-nav__link">
      App 3 [Services] Vistas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/app-blog-relaciones/" title="App 4 [Blog] Relaciones" class="md-nav__link">
      App 4 [Blog] Relaciones
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/personalizando-panel-administrador-parte-2/" title="Personalizando el admin (2)" class="md-nav__link">
      Personalizando el admin (2)
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/crear-vistas-blog-1/" title="Creando vistas del Blog (1)" class="md-nav__link">
      Creando vistas del Blog (1)
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/crear-vistas-blog-2/" title="Creando vistas del Blog (2)" class="md-nav__link">
      Creando vistas del Blog (2)
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/app-social-enlaces-redes/" title="App 5 [Social] Redes sociales" class="md-nav__link">
      App 5 [Social] Redes sociales
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/procesadores-contexto/" title="Procesadores de contexto" class="md-nav__link">
      Procesadores de contexto
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/app-pages-gestor-paginas/" title="App 6 [Pages] Páginas" class="md-nav__link">
      App 6 [Pages] Páginas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/template-tags-propios/" title="Template tags propios" class="md-nav__link">
      Template tags propios
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/ordenar-editar-paginas/" title="Ordenar y editar páginas" class="md-nav__link">
      Ordenar y editar páginas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/personalizando-panel-administrador-parte-3/" title="Personalizando el admin (3)" class="md-nav__link">
      Personalizando el admin (3)
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/app-contact-formularios/" title="App 7 [Contact] Formularios" class="md-nav__link">
      App 7 [Contact] Formularios
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/formularios-procesado-validacion/" title="Procesar validar formularios" class="md-nav__link">
      Procesar validar formularios
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/fusion-formulario/" title="Fusionando el formulario" class="md-nav__link">
      Fusionando el formulario
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/enviar-emails-prueba/" title="Enviando emails de prueba" class="md-nav__link">
      Enviando emails de prueba
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-empresarial/personalizando-panel-administrador-parte-4/" title="Personalizando el admin (4)" class="md-nav__link">
      Personalizando el admin (4)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
            
            
            


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      Proyecto Web Playground
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Proyecto Web Playground
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/" title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/preparar-app-core/" title="Preparar la app [Core]" class="md-nav__link">
      Preparar la app [Core]
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/cbv-templateview/" title="CBV y TemplateView" class="md-nav__link">
      CBV y TemplateView
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/preparar-app-pages/" title="Preparando la App [Pages]" class="md-nav__link">
      Preparando la App [Pages]
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/cbv-listview-detailview/" title="ListView y DetailView" class="md-nav__link">
      ListView y DetailView
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/cbv-createview/" title="CBV CRUD CreateView" class="md-nav__link">
      CBV CRUD CreateView
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/cbv-updateview/" title="CBV CRUD UpdateView" class="md-nav__link">
      CBV CRUD UpdateView
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/cbv-deleteview/" title="CBV CRUD DeleteView" class="md-nav__link">
      CBV CRUD DeleteView
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/cbv-forms-models/" title="CBV Forms para Modelos" class="md-nav__link">
      CBV Forms para Modelos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/mixin-identificacion/" title="Mixin de identificación" class="md-nav__link">
      Mixin de identificación
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/decoradores-identificacion/" title="Decorador identificación" class="md-nav__link">
      Decorador identificación
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/app-registration-sesiones/" title="App 8 [Registration] Sesión" class="md-nav__link">
      App 8 [Registration] Sesión
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/cerrar-sesion/" title="Cerrando la sesión" class="md-nav__link">
      Cerrando la sesión
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/cbv-registro/" title="Registro con CBV" class="md-nav__link">
      Registro con CBV
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/email-registro-obligatorio/" title="Email de registro obligatorio" class="md-nav__link">
      Email de registro obligatorio
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/validar-email-unico/" title="Validando un email único" class="md-nav__link">
      Validando un email único
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/restaurar-contrasena/" title="Restauración de contraseña" class="md-nav__link">
      Restauración de contraseña
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/crear-perfil-usuario/" title="Creando un perfil de usuario" class="md-nav__link">
      Creando un perfil de usuario
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/formulario-edicion-perfil/" title="Haciendo editable el perfil" class="md-nav__link">
      Haciendo editable el perfil
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/mejorando-formulario-perfil/" title="Mejorando el form de perfil" class="md-nav__link">
      Mejorando el form de perfil
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/edicion-email/" title="Edición de email" class="md-nav__link">
      Edición de email
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/edicion-contrasena/" title="Edición de contraseña" class="md-nav__link">
      Edición de contraseña
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/introduccion-senales-signals/" title="Introducción a las señales" class="md-nav__link">
      Introducción a las señales
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/introduccion-pruebas-unitarias-unittest/" title="Introducción a las unittest" class="md-nav__link">
      Introducción a las unittest
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/optimizar-almacenamiento-avatar/" title="Optimizando el avatar" class="md-nav__link">
      Optimizando el avatar
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/app-profiles-perfiles-publicos/" title="App 9 [Profiles] Perfiles" class="md-nav__link">
      App 9 [Profiles] Perfiles
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/paginacion-cbv-listview/" title="Paginación en ListView" class="md-nav__link">
      Paginación en ListView
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/app-messenger-mensajeria/" title="App 10 [Messenger] Análisis" class="md-nav__link">
      App 10 [Messenger] Análisis
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/tdd-primeras-pruebas/" title="TDD (1) Primeras pruebas" class="md-nav__link">
      TDD (1) Primeras pruebas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/tdd-refactorizacion/" title="TDD (2) Refactorización" class="md-nav__link">
      TDD (2) Refactorización
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/tdd-model-manager/" title="TDD (3) Model Manager" class="md-nav__link">
      TDD (3) Model Manager
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/urls-vistas-templates/" title="URLs, vistas y templates" class="md-nav__link">
      URLs, vistas y templates
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/mensajes-asincronos-javascript-1/" title="Mensajes asíncronos JS (1)" class="md-nav__link">
      Mensajes asíncronos JS (1)
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/mensajes-asincronos-javascript-2/" title="Mensajes asíncronos JS (2)" class="md-nav__link">
      Mensajes asíncronos JS (2)
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/mensajes-asincronos-javascript-3/" title="Mensajes asíncronos JS (3)" class="md-nav__link">
      Mensajes asíncronos JS (3)
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/programando-conversaciones/" title="Programar conversaciones" class="md-nav__link">
      Programar conversaciones
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../web-playground/detalle-final/" title="El detalle final" class="md-nav__link">
      El detalle final
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
            
            
            

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5" checked>
    
    <label class="md-nav__link" for="nav-4-5">
      Proyecto API Rest
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        Proyecto API Rest
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../" title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

        
            
            
            

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Sistema de autenticación
      </label>
    
    <a href="./" title="Sistema de autenticación" class="md-nav__link md-nav__link--active" id="md__active_link">
      Sistema de autenticación
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#entorno-y-proyecto" title="Entorno y proyecto" class="md-nav__link toc__link">
    Entorno y proyecto
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app-de-autenticacion" title="App de autenticación" class="md-nav__link toc__link">
    App de autenticación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-user" title="Custom User" class="md-nav__link toc__link">
    Custom User
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sistemas-de-autenticacion" title="Sistemas de autenticación" class="md-nav__link toc__link">
    Sistemas de autenticación
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basica" title="Básica" class="md-nav__link toc__link">
    Básica
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-keys" title="API Keys" class="md-nav__link toc__link">
    API Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bearer" title="Bearer" class="md-nav__link toc__link">
    Bearer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json-web-tokens" title="JSON Web Tokens" class="md-nav__link toc__link">
    JSON Web Tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oauth2" title="OAuth2" class="md-nav__link toc__link">
    OAuth2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#el-mejor-sistema-de-autenticacion-para-api" title="El mejor sistema de autenticación para API" class="md-nav__link toc__link">
    El mejor sistema de autenticación para API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#login-y-logout" title="Login y logout" class="md-nav__link toc__link">
    Login y logout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#probando-la-autenticacion" title="Probando la autenticación" class="md-nav__link toc__link">
    Probando la autenticación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serializando-el-usuario" title="Serializando el usuario" class="md-nav__link toc__link">
    Serializando el usuario
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registro-de-usuarios" title="Registro de usuarios" class="md-nav__link toc__link">
    Registro de usuarios
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recuperar-contrasena" title="Recuperar contraseña" class="md-nav__link toc__link">
    Recuperar contraseña
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peticiones-cors" title="Peticiones CORS" class="md-nav__link toc__link">
    Peticiones CORS
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../sistema-peliculas-generos/" title="Sistema de películas" class="md-nav__link">
      Sistema de películas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../sistema-busqueda-filtro/" title="Sistema de búsqueda" class="md-nav__link">
      Sistema de búsqueda
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../sistema-perfiles-usuario/" title="Sistema de perfiles de usuario" class="md-nav__link">
      Sistema de perfiles de usuario
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../sistema-peliculas-usuario/" title="Sistema de películas de usuario" class="md-nav__link">
      Sistema de películas de usuario
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
            
            
            


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      Producción
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        Producción
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../../produccion/" title="Entornos de producción" class="md-nav__link">
      Entornos de producción
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../produccion/repositorios-controles-de-versiones/" title="Repositorios y SCV" class="md-nav__link">
      Repositorios y SCV
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../produccion/creando-repositorio-github/" title="Creando repositorio en Github" class="md-nav__link">
      Creando repositorio en Github
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../../produccion/desplegar-proyecto-prueba/" title="Desplegar proyecto de prueba" class="md-nav__link">
      Desplegar proyecto de prueba
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  </ul>
</nav>
</div>
                  </div>
                </div>
              
              
                <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                  <div class="md-sidebar__scrollwrap">
                    <div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#entorno-y-proyecto" title="Entorno y proyecto" class="md-nav__link toc__link">
    Entorno y proyecto
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app-de-autenticacion" title="App de autenticación" class="md-nav__link toc__link">
    App de autenticación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-user" title="Custom User" class="md-nav__link toc__link">
    Custom User
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sistemas-de-autenticacion" title="Sistemas de autenticación" class="md-nav__link toc__link">
    Sistemas de autenticación
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basica" title="Básica" class="md-nav__link toc__link">
    Básica
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-keys" title="API Keys" class="md-nav__link toc__link">
    API Keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bearer" title="Bearer" class="md-nav__link toc__link">
    Bearer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json-web-tokens" title="JSON Web Tokens" class="md-nav__link toc__link">
    JSON Web Tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oauth2" title="OAuth2" class="md-nav__link toc__link">
    OAuth2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#el-mejor-sistema-de-autenticacion-para-api" title="El mejor sistema de autenticación para API" class="md-nav__link toc__link">
    El mejor sistema de autenticación para API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#login-y-logout" title="Login y logout" class="md-nav__link toc__link">
    Login y logout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#probando-la-autenticacion" title="Probando la autenticación" class="md-nav__link toc__link">
    Probando la autenticación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serializando-el-usuario" title="Serializando el usuario" class="md-nav__link toc__link">
    Serializando el usuario
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registro-de-usuarios" title="Registro de usuarios" class="md-nav__link toc__link">
    Registro de usuarios
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recuperar-contrasena" title="Recuperar contraseña" class="md-nav__link toc__link">
    Recuperar contraseña
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peticiones-cors" title="Peticiones CORS" class="md-nav__link toc__link">
    Peticiones CORS
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav></div>
                  </div>
                </div>
              
            
            <div class="md-content">
              <article class="md-content__inner md-typeset">
                
                  
                  
                  <h1 id="sistema-de-autenticacion-y-registro-en-drf">Sistema de autenticación y registro en DRF<a class="headerlink" href="#sistema-de-autenticacion-y-registro-en-drf" title="Permanent link">&para;</a></h1>
<p>En esta unidad vamos a implementar todo el sistema de autenticación de usuarios de nuestra API, el cuál controlará diferentes aspectos como:</p>
<ul>
<li>El registro</li>
<li>El login y logout</li>
<li>La recuperación de contraseña</li>
</ul>
<p>Toda nuestra API gira alrededor de este sistema, por eso nos tomaremos el tiempo necesario para explicar cuidadosamente cada paso de su desarrollo. Podéis estar seguros de que lo aprendido aquí os servirá en prácticamente todas vuestras futuras APIs creadas con DRF.</p>
<h2 id="entorno-y-proyecto">Entorno y proyecto<a class="headerlink" href="#entorno-y-proyecto" title="Permanent link">&para;</a></h2>
<p>Vamos a partir de una carpeta llamada <strong>mispelis/</strong> que vamos a abrir en VSC , y desde ahí abriremos una terminal <strong>CMD</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Instalamos Pipenv</span>
pip<span class="w"> </span>install<span class="w"> </span>pipenv
</code></pre></div>
<p>A continuación:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Creamos un entorno instalando django</span>
pipenv<span class="w"> </span>install<span class="w"> </span>django
</code></pre></div>
<p>Creamos el proyecto:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Le llamaremos &quot;server&quot;</span>
pipenv<span class="w"> </span>run<span class="w"> </span>django-admin<span class="w"> </span>startproject<span class="w"> </span>server
</code></pre></div>
<p>Ahora configuraremos el entorno virtual en VSC abriendo el fichero <strong>manage.py</strong>.</p>
<p>Al abrirlo nos aparecerá en la parte inferior de VSC el intérprete activo, hacemos clic, buscamos uno llamado <strong>server</strong> y lo activamos.</p>
<p>Veremos como a partir de ahora nos aparece <strong>server-XXXXXX</strong> abajo, eso significa que todos los ficheros Python del proyecto se están ejecutando con el intérprete de nuestro entorno virtual.</p>
<p>Inmediatamente después de configurar el entorno, nos pedirá instalar <strong>pylint</strong> en las dependencias, lo hacemos, ya que nos señalará posibles fallos en el código.</p>
<p>Bien, vamos a comprobar si funciona nuestro proyecto:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>server
pipenv<span class="w"> </span>run<span class="w"> </span>python<span class="w"> </span>manage.py<span class="w"> </span>runserver
</code></pre></div>
<p>Si todo funciona podremos acceder a <code>http://127.0.0.1:8000/</code>. Podemos cambiar el idioma del proyecto:</p>
<p><strong><code>mispelis/server/settings.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="n">LANGUAGE_CODE</span> <span class="o">=</span> <span class="s1">&#39;es&#39;</span>
</code></pre></div>
<p>Justo después de guardar el primer fichero python del proyecto VSC nos pedirá instalar la extensión <strong>autopep8</strong>, la instalamos. Este paquete nos formateará el código automáticamente cumpliendo las pautas definidas en el pep8.</p>
<p>Si todo ha ido bien deberíamos tener <strong>django</strong> ya funcionando en español.</p>
<p>Por último en esta lección vamos a crear unos scripts en nuestro entorno para manejar más fácilmente <strong>django</strong>.</p>
<p><strong><code>mispelis/Pipfile</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">scripts</span><span class="p">]</span>
<span class="n">server</span>          <span class="o">=</span> <span class="s2">&quot;python manage.py runserver&quot;</span>
<span class="n">migrate</span>         <span class="o">=</span> <span class="s2">&quot;python manage.py migrate&quot;</span>
<span class="n">startapp</span>        <span class="o">=</span> <span class="s2">&quot;python manage.py startapp&quot;</span>
<span class="n">makemigrations</span>  <span class="o">=</span> <span class="s2">&quot;python manage.py makemigrations&quot;</span>
<span class="n">createsuperuser</span> <span class="o">=</span> <span class="s2">&quot;python manage.py createsuperuser&quot;</span>
</code></pre></div>
<p>Cerramos el servicio y testeamos:</p>
<div class="highlight"><pre><span></span><code>pipenv<span class="w"> </span>run<span class="w"> </span>server
</code></pre></div>
<p>Con esto es suficiente para empezar a programar nuestra API.</p>
<h2 id="app-de-autenticacion">App de autenticación<a class="headerlink" href="#app-de-autenticacion" title="Permanent link">&para;</a></h2>
<p>Vamos a empezar nuestro desarrollo con una <strong>app</strong> que maneje la autenticación, la parte de la API que manejará las funcionalidades de:</p>
<ul>
<li>Registrar una cuenta</li>
<li>Iniciar y cerrar sesión</li>
<li>Restaurar contraseña</li>
</ul>
<p>Empezamos por aquí porque la API que vamos a desarrollar es privada, accesible sólo a usuarios registrados e identificados. Nos os preocupéis por esto, ya que eventualmente también veremos cómo librerar una vista y hacerla accesible sin autenticación.</p>
<p>Dicho lo cuál, vamos crear la app de autenticación:</p>
<div class="highlight"><pre><span></span><code>pipenv<span class="w"> </span>run<span class="w"> </span>startapp<span class="w"> </span>authentication
</code></pre></div>
<p>Podéis ponerle cualquier nombre menos <strong>auth</strong> a secas, ya que ese nombre es el de una app interna <strong>django.contrib.auth</strong> y no debemos sobreescribirlo.</p>
<p>La activamos debajo de las <strong>apps</strong> por defecto de Django:</p>
<p><strong><code>server/settings.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>

    <span class="c1"># Django internal apps</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>

    <span class="c1"># Django custom apps</span>
    <span class="s1">&#39;authentication&#39;</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>
<p>Antes de ponernos con las vistas vamos a dejar instalado y configurado <strong>Django Rest Framework</strong>, la app que nos permite transformar Django en un servidor de APIs:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>server
pipenv<span class="w"> </span>install<span class="w"> </span>djangorestframework
</code></pre></div>
<p>La activamos:</p>
<p><strong><code>server/settings.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>

    <span class="c1"># Django internal apps</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>

    <span class="c1"># Django external apps</span>
    <span class="s1">&#39;rest_framework&#39;</span><span class="p">,</span>

    <span class="c1"># Django custom apps</span>
    <span class="s1">&#39;authentication&#39;</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>
<p>Muy bien, en la siguiente lección vamos a crear el modelo para los usuarios de nuestra aplicación.</p>
<h2 id="custom-user">Custom User<a class="headerlink" href="#custom-user" title="Permanent link">&para;</a></h2>
<p>El modelo de usuario que trae Django es algo limitado y nosotros necesitamos añadir algunos campos nuevos. Una forma de hacerlo es crear un modelo <strong>Profile</strong> enlazado a cada usuario con los campos que queremos, sin embargo en este curso vamos a hacerlo de una forma más profesional: <strong>personalizar el usuario base</strong>.</p>
<p><strong>IMPORTANTE</strong>: Antes de continuar es clave no haber creado ningún usuario en la base de datos. Si lo habéis hecho, borrad la base de datos <strong>db.sqlite3</strong> y todos los ficheros del directorio <strong>migrations</strong> excepto los llamados <code>__init__.py</code>.</p>
<p>Para extender el modelo de usuario, vamos a crear un <strong>CustomUser</strong> en nuestra app. La diferencia más importante respecto a un usuario "clásico" es que, si bien Django maneja como campo identificador el <strong>username</strong>, nosotros lo identificaremos con el <strong>email</strong>.</p>
<p><strong><code>authentication/models.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractUser</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CustomUser</span><span class="p">(</span><span class="n">AbstractUser</span><span class="p">):</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>Según la <a href="https://docs.djangoproject.com/en/3.1/topics/auth/customizing/#django.contrib.auth.models.CustomUser.USERNAME_FIELD">documentación</a> para establecer el campo identificador único del <strong>User</strong> tenemos que definir lo siguiente:</p>
<p><strong><code>authentication/models.py</code></strong></p>
<div class="highlight"><pre><span></span><code>    <span class="n">USERNAME_FIELD</span> <span class="o">=</span> <span class="s1">&#39;email&#39;</span>  <span class="c1"># new</span>
</code></pre></div>
<p>Con estos cambios los usuarios podrán iniciar sesión con el correo en lugar de usar su username.</p>
<p>En este punto repasemos los campos obligatorios del formulario de registro:</p>
<ul>
<li>Email: que debe ser único y se utilizará como identificador para acceder.</li>
<li>Username: que también debe ser único y se mostrará en el perfil.</li>
<li>Password: para la contraseña del usuario.</li>
</ul>
<p>Según la <a href="https://docs.djangoproject.com/en/3.1/topics/auth/customizing/#django.contrib.auth.models.CustomUser.REQUIRED_FIELDS">documentación</a>, para obligar al usuario a introducir un campo debemos indicarlo en una lista:</p>
<p><strong><code>authentication/models.py</code></strong></p>
<div class="highlight"><pre><span></span><code>    <span class="n">REQUIRED_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">]</span>  <span class="c1"># new</span>
</code></pre></div>
<p>Fijaros que hacemos referencia a <strong>username</strong> y <strong>password</strong> pero nunca los definimos. Eso es porque se heredan del <strong>AbstractUser</strong>. De hecho el propio <strong>email</strong> también se hereda, pero como por defecto no es obligatorio ni único, tenemos que cambiar su configuración tal como hemos hecho.</p>
<p>Ahora vamos a decirle a Django que utilice el <strong>CustomUser</strong> en lugar de su modelo genérico:</p>
<p><strong><code>server/settings.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Custom user model</span>
<span class="n">AUTH_USER_MODEL</span> <span class="o">=</span> <span class="s2">&quot;authentication.CustomUser&quot;</span>
</code></pre></div>
<p>Hacemos la migración inicial junto con nuestra app:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>server
pipenv<span class="w"> </span>run<span class="w"> </span>makemigrations
pipenv<span class="w"> </span>run<span class="w"> </span>migrate
</code></pre></div>
<p>Vamos a crear un usuario admin para acceder a nuestra administración. Si todo va bien debería pedirnos el email como identificador, a parte de un username:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>server
pipenv<span class="w"> </span>run<span class="w"> </span>createsuperuser

&gt;<span class="w"> </span>Email:<span class="w"> </span>admin@admin.com
&gt;<span class="w"> </span>Nombre<span class="w"> </span>de<span class="w"> </span>usuario:<span class="w"> </span>admin
&gt;<span class="w"> </span>Contraseña:<span class="w"> </span><span class="m">1234</span>
&gt;<span class="w"> </span>Superuser<span class="w"> </span>created<span class="w"> </span>successfully.
</code></pre></div>
<p>Perfecto, si ponemos en marcha el servidor deberíamos ser capaces de acceder al panel de administración <code>http://127.0.0.1:8000/admin/</code></p>
<p>Al hacerlo notaremos no podemos gestionar usuarios automáticamente. Algo entendible al haber creado nuestro propio modelo.</p>
<p>Para tener de el admin hay que configurarlo manualmente como un modelo cualquiera, la ventaja es que podemos heredar el del usuario por defecto.</p>
<p>No entraremos en detalle porque asumo que la mayoría tenéis conocimientos básicos sobre el panel de administrador. Si no es el caso os recomiendo mi otro curso de introducción a Django.</p>
<p><strong><code>authentication/admin.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_user_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.admin</span><span class="w"> </span><span class="kn">import</span> <span class="n">UserAdmin</span>


<span class="nd">@admin</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">get_user_model</span><span class="p">())</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CustomUserAdmin</span><span class="p">(</span><span class="n">UserAdmin</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>
<p>En cualquier caso ya deberíamos tener acceso a nuestro modelo para crear, editar y borar usuarios desde el administrador. Y si queréis incluso podemos desactivar los grupos porque no los vamos a utilizar:</p>
<p><strong><code>authentication/admin.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Group</span>  <span class="c1"># new</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">Group</span><span class="p">)</span>  <span class="c1"># new</span>
</code></pre></div>
<p>Ya estamos listos para empezar con las vistas de la API, pero antes tenemos que tomar una decisión muy importante.</p>
<h2 id="sistemas-de-autenticacion">Sistemas de autenticación<a class="headerlink" href="#sistemas-de-autenticacion" title="Permanent link">&para;</a></h2>
<p>Las APIs REST como la que vamos a crear permiten implementar diferentes protocolos de autenticación. Vamos a repasar brevemente los más famosos:</p>
<h4 id="basica">Básica<a class="headerlink" href="#basica" title="Permanent link">&para;</a></h4>
<p>Es el método más sencillo pero inseguro, ya que se basa en enviar el usuario y su contraseña codificadas en <strong>Base64</strong> en las cabeceras de cada petición. Tened en cuenta que la codificiación en Base64 es una formalidad y es tan sencillo descodificar una cadena en este formato como pasar el valor a una función de cualquier lenguaje de programación.</p>
<div class="highlight"><pre><span></span><code>Authorization:<span class="w"> </span>Basic<span class="w"> </span>base64<span class="o">(</span>username:password<span class="o">)</span>
</code></pre></div>
<h4 id="api-keys">API Keys<a class="headerlink" href="#api-keys" title="Permanent link">&para;</a></h4>
<p>Otro sistema bastante utilizado es enviar una <strong>key</strong> facilitada por la API que sustituye las credenciales de un usuario. Muchas APIs públicas ofrecen este sistema porque es fácil añadirle un límite de peticiones diarias, pero en la práctica es sustituir la cadena de autenticación por la clave que se provee a cliente.</p>
<div class="highlight"><pre><span></span><code>Authorization: Apikey &lt;key&gt;
</code></pre></div>
<h4 id="bearer">Bearer<a class="headerlink" href="#bearer" title="Permanent link">&para;</a></h4>
<p>También conocida como <em>Token Authentication</em> se basa en proveer al cliente de un "código" después de identificarse por primera vez. En lugar de enviar todo el rato el usuario y su contraseña, el cliente envía ese código generado por el backend en la cabecera de las peticiones. Es igual de inseguro que la autenticación básica, pero como mínimo no se mandan las credenciales en cada petición.</p>
<div class="highlight"><pre><span></span><code>Authorization: Bearer &lt;token&gt;
</code></pre></div>
<h4 id="json-web-tokens">JSON Web Tokens<a class="headerlink" href="#json-web-tokens" title="Permanent link">&para;</a></h4>
<p>Los JWT son un estándar abierto de la industria para representar peticiones de forma "segura" entre dos partes. Este sistema añade una capa extra de seguridad en los tokens, con mecanismos de decodificación, verificación y renovación de los mismos.</p>
<div class="highlight"><pre><span></span><code>Authorization: Bearer &lt;JWT token&gt;
</code></pre></div>
<h4 id="oauth2">OAuth2<a class="headerlink" href="#oauth2" title="Permanent link">&para;</a></h4>
<p>Este sistema de autenticación permite compartir información entre sitios sin compartir las credenciales del usuario. En lugar de generar el token en nuestro backend se delega este proceso una plataforma de terceros, de manera que no necesitamos almacenar el usuario y la contraseña en la base de datos. Oauth2 es muy cómodo, pero si tenemos interés en almacenar información del usuario en nuestra base de datos igualmente necesitaremos implementar un sistema de usuarios y pedirle la información a esas plataformas de terceros. Casi nunca se utiliza como sistema único de autenticación, sino como apoyo de nuestro propio sistema.</p>
<div class="highlight"><pre><span></span><code>Authorization: Bearer &lt;Oauth2 token&gt;
</code></pre></div>
<h4 id="el-mejor-sistema-de-autenticacion-para-api">El mejor sistema de autenticación para API<a class="headerlink" href="#el-mejor-sistema-de-autenticacion-para-api" title="Permanent link">&para;</a></h4>
<p>Con esto hemos cubierto prácticamente todos los sistemas de autenticación. ¿Cuál vamos a utilizar? Pues... ninguno de ellos.</p>
<p>Veréis, la gracia de las APIs es que permiten separar la lógica del servidor y la del cliente. Sin embargo esto tiene un problema inherente y es que los clientes deben almacenar las credenciales de acceso en la memoria para poder enviarlas en las peticiones.</p>
<p>Que la información se encuentre almacenada en el cliente implica un defecto de facto en un cliente web y es que esas credenciales SIEMPRE son accesibles a través de JavaScript y por tanto son vulnerables a ser accedidas utilizando ataques XSS (Cross-site Scripting), <a href="https://es.wikipedia.org/wiki/Cross-site_scripting">os dejo un enlace</a>.</p>
<p>Por tanto el problema radica en la propia naturaleza de JavaScript... ¿Cómo lo solucionamos? Pues haciendo inaccesibles las credenciales en el cliente.</p>
<p>Espera espera Héctor... ¿Eso se puede hacer? ¿Cómo va a enviar las credenciales el cliente si no tiene acceso a ellas? La respuesta está en las <strong>cookies</strong>.</p>
<p>Ya sé lo que estáis pensando algunos... las cookies también son accesibles desde Javascript y por tanto vulnerables a ataques XSS, así que no vamos a solucionar nada. Sin embargo, y por suerte para nosotros, existe una cláusula en las cookies llamada <strong>HttpOnly</strong> que Django activa automáticamente en las sesiones. Esta opción hace que las cookies sean inaccesibles desde JavaScript y que sea el propio navegador quien las gestiona.</p>
<p>Con todo esto lograremos un sistema muy robusto, seguro y fácil de implementar.</p>
<p>Solo debemos indicar en las peticiones de JavaScript que deseamos enviar las credenciales de la cookie de sesión. Por ejemplo usando <code>axios</code> podemos preconfigurarlo así:</p>
<div class="highlight"><pre><span></span><code><span class="nx">axios</span><span class="p">.</span><span class="nx">defaults</span><span class="p">.</span><span class="nx">baseURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;http://localhost:8000/api&quot;</span><span class="p">;</span>
<span class="nx">axios</span><span class="p">.</span><span class="nx">defaults</span><span class="p">.</span><span class="nx">withCredentials</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</code></pre></div>
<p>O en cada petición enviar el campo de esta forma:</p>
<div class="highlight"><pre><span></span><code><span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://localhost:8000/api&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">withCredentials</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">});</span>
</code></pre></div>
<p>¡Gracias Django!</p>
<h2 id="login-y-logout">Login y logout<a class="headerlink" href="#login-y-logout" title="Permanent link">&para;</a></h2>
<p>Vamos a empezar creando unas vistas básicas de <strong>login</strong> y <strong>logout</strong> usando una <strong>APIView</strong> básica de DRF. La forma de implementar la lógica es exactamente igual que con Django clásico, os dejo el enlace a la <a href="https://docs.djangoproject.com/en/3.1/topics/auth/default/#how-to-log-a-user-in">documentación oficial</a> por si queréis profundizar:</p>
<p><strong><code>authentication/views.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">authenticate</span><span class="p">,</span> <span class="n">login</span><span class="p">,</span> <span class="n">logout</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">status</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">Response</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">APIView</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LoginView</span><span class="p">(</span><span class="n">APIView</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="c1"># Recuperamos las credenciales y autenticamos al usuario</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>

        <span class="c1"># Si es correcto añadimos a la request la información de sesión</span>
        <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
            <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
                <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>

        <span class="c1"># Si no es correcto devolvemos un error en la petición</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
            <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_404_NOT_FOUND</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LogoutView</span><span class="p">(</span><span class="n">APIView</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="c1"># Borramos de la request la información de sesión</span>
        <span class="n">logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="c1"># Devolvemos la respuesta al cliente</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
</code></pre></div>
<p>Configuramos las dos URL en la app:</p>
<p><strong><code>authentication/urls.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">include</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">LoginView</span><span class="p">,</span> <span class="n">LogoutView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Auth views</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;auth/login/&#39;</span><span class="p">,</span>
         <span class="n">LoginView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;auth_login&#39;</span><span class="p">),</span>

    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;auth/logout/&#39;</span><span class="p">,</span>
         <span class="n">LogoutView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;auth_logout&#39;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>
<p>Y configuramos las URL de la app en el proyecto:</p>
<p><strong><code>server/urls.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">include</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">routers</span>

<span class="c1"># Api router</span>
<span class="n">router</span> <span class="o">=</span> <span class="n">routers</span><span class="o">.</span><span class="n">DefaultRouter</span><span class="p">()</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Admin routes</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>

    <span class="c1"># Api routes</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;authentication.urls&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;api/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">router</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
<span class="p">]</span>
</code></pre></div>
<p>Con esta estructura tenemos dos endpoints:</p>
<ul>
<li><code>/api/auth/login/</code></li>
<li><code>/api/auth/logout/</code></li>
</ul>
<p>En la siguiente lección probaremos si funcionan correctamente.</p>
<h2 id="probando-la-autenticacion">Probando la autenticación<a class="headerlink" href="#probando-la-autenticacion" title="Permanent link">&para;</a></h2>
<p>Ha llegado la hora de probar la API, la forma más fácil es desde la interfaz que nos provee DRF.</p>
<p>Acceded a la URL de <strong>login</strong> <code>http://localhost:8000/api/auth/login/</code> y escribid las credenciales en crudo como si fuera un objeto JSON:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"> </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin@admin.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1234&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Si todo funciona correctamente al enviar el formulario veréis la respuesta de la API y saldrá vuestro email arriba a la derecha indicando que efectivamente estamos identificados:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"> </span><span class="nt">&quot;login&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Para probar el <strong>logout</strong>, estando identificados, accedemos a la URL pertinente <code>http://localhost:8000/api/auth/logout/</code> y al enviar el formulario vacío debería hacernos lo propio:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"> </span><span class="nt">&quot;logout&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Si nos logeamos ahora nos devolverá la información que hemos establecido en el serializador:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin@admin.com&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pbkdf2_sha....&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>Como el campo password no nos interesa serializado vamos a establecer una clásula de sólo escritura, para que Django sólo lo tenga en cuenta al crear o modificar, pero nunca al hacer una lectura:</p>
<div class="highlight"><pre><span></span><code><span class="n">password</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
    <span class="n">min_length</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">write_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<h2 id="serializando-el-usuario">Serializando el usuario<a class="headerlink" href="#serializando-el-usuario" title="Permanent link">&para;</a></h2>
<p>Uno de los requisitos del frontend es que justo después de identificarnos la API debe enviar información básica del usuario para utilizarla en la aplicación, como por ejemplo el nombre, el email o más adelante el avatar.</p>
<p>Cuando nos autenticamos conseguimos un objeto <strong>user</strong> con toda esa información, pero no podemos enviarlo al cliente y ya está, necesitamos transformarlo a un objeto JSON. Ese proceso de transformar el objeto de un formato a otro, Python a Javascript en nuestro caso, se conoce como seralización.</p>
<p>DRF permite crear serializadores de modelos para automatizar esta tarea, así que vamos a crear nuestro propio serializador de usuarios:</p>
<p><strong><code>authentication/serializers.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_user_model</span>


<span class="k">class</span><span class="w"> </span><span class="nc">UserSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">get_user_model</span><span class="p">()</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Este serializador básico, a parte de controlar los campos que queremos serializar de Python a JSON, también nos servirá más adelante para configurar métodos como la creación de usuarios durante el registro y la validación personalizada de campos.</p>
<p>Sea como sea vamos a serializar el objeto <strong>user</strong> y a enviarlo como respuesta de la petición de login:</p>
<p><strong><code>authentication/views.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="n">UserSerializer</span>

<span class="c1"># ...</span>

<span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
    <span class="n">UserSerializer</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
    <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
</code></pre></div>
<h2 id="registro-de-usuarios">Registro de usuarios<a class="headerlink" href="#registro-de-usuarios" title="Permanent link">&para;</a></h2>
<p>En esta lección vamos a por la vista de registro, donde a partir de un email, username y password crearemos usuarios en la base de datos.</p>
<p>DRF tiene una vista llamada <strong>CreateAPIView</strong> que automatiza la tarea de crear instancias a partir de un serializador, vamos a usarla para facilitarnos la vida:</p>
<p><strong><code>authentication/views.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">rest_framework</span><span class="w"> </span><span class="kn">import</span> <span class="n">generics</span><span class="p">,</span> <span class="n">status</span>

<span class="c1"># ...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SignupView</span><span class="p">(</span><span class="n">generics</span><span class="o">.</span><span class="n">CreateAPIView</span><span class="p">):</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">UserSerializer</span>
</code></pre></div>
<p>Añadimos la vista a la URL y a probar si funciona:</p>
<p><strong><code>authentication/urls.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">include</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">LoginView</span><span class="p">,</span> <span class="n">LogoutView</span><span class="p">,</span> <span class="n">SignupView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ...</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;auth/signup/&#39;</span><span class="p">,</span>
         <span class="n">SignupView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;auth_signup&#39;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>
<p>Ahora probamos el formulario de registro en el endpoint <code>http://localhost:8000/api/auth/signup/</code> y...</p>
<div class="highlight"><pre><span></span><code>Email: test@test.com
Username: test
Password: 12345678
</code></pre></div>
<p>¡Parece que funcionó! Pero no cantemos victoria, vamos a revisar desde el panel de administración si está todo correcto.</p>
<p>Al entrar al panel de administración vemos que efectivamente el usuario existe, sin embargo al acceder más a fondo podemos comprobar un aviso preocupaunte:</p>
<div class="highlight"><pre><span></span><code>Formato de clave incorrecto o algoritmo de hash desconocido.
</code></pre></div>
<p>¿Sabéis que ha pasado? Que las contraseñas de usuario en Django se tienen que guardar encriptadas y nosotros la hemos guardado en crudo.</p>
<p>Para codificar la contraseña se me ha ocurrido una forma muy sencilla. Podemos añadir un validador al campo password y utilizar el método <strong>make_password</strong> de Django que lo codifica él solito:</p>
<p><strong><code>authentication/serializers.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.hashers</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_password</span>

<span class="c1"># ...</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">make_password</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
<p>Voy a <strong>borrar el usuario test</strong> y a probar si esta vez funciona bien:</p>
<div class="highlight"><pre><span></span><code>Email: test@test.com
Username: test
Password: 12345678
</code></pre></div>
<p>Y...</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test@test.com&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>Si consultamos el administrador ya no aparece el error de codificación y podemos iniciar sesión sin problema:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"> </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test@test.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;12345678&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>¡Listo!</p>
<h2 id="recuperar-contrasena">Recuperar contraseña<a class="headerlink" href="#recuperar-contrasena" title="Permanent link">&para;</a></h2>
<p>Un buen sistema de autenticación debe proveer una función de recuperación de contraseña para usuarios despistados.</p>
<p>Una funcionalidad así requiere bastante planificación, crear varias vistas, confirmaciones por email, etc. Sin embargo investigando un poco encontré una <strong>app</strong> de Django que nos hará la mayor parte del trabajo, vamos a instalarla y configurarla:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>server
pipenv<span class="w"> </span>install<span class="w"> </span>django-rest-passwordreset
</code></pre></div>
<p>Una vez instalada la añadimos a las <strong>apps</strong> del proyecto:</p>
<p><strong><code>server/settings.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>

    <span class="c1"># Django internal apps</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>

    <span class="c1"># Django external apps</span>
    <span class="s1">&#39;rest_framework&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django_rest_passwordreset&#39;</span><span class="p">,</span>  <span class="c1"># new</span>

    <span class="c1"># Django custom apps</span>
    <span class="s1">&#39;authentication&#39;</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>
<p>Según la <a href="https://github.com/anexia-it/django-rest-passwordreset">documentación</a> de esta app, ahora tenemos que migrar para crear algunos campos en la base de datos:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>server
pipenv<span class="w"> </span>run<span class="w"> </span>migrate
</code></pre></div>
<p>Añadir un endpoint para manejar las vistas de recuperar contraseña:</p>
<p><strong><code>authentication/urls.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ...</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;auth/reset/&#39;</span><span class="p">,</span>
         <span class="n">include</span><span class="p">(</span><span class="s1">&#39;django_rest_passwordreset.urls&#39;</span><span class="p">,</span>
                 <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;password_reset&#39;</span><span class="p">)),</span>
<span class="p">]</span>
</code></pre></div>
<p>Con esto podemos acceder al endpoint de la API para recuperar una contraseña y probar si funciona <code>http://localhost:8000/api/auth/reset/</code>:</p>
<div class="highlight"><pre><span></span><code>test@test.com
</code></pre></div>
<p>Esta petición nos devolverá:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OK&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>¿Qué ha ocurrido? ¿Se supone que debería haber enviado mágicamente un correo? Pues no, esta petición sólo genera el token de recuperación en la tabla de la app. Podemos confirmarlo consultando el panel de administrador.</p>
<p>Para completar el ciclo falta un paso, enviar el correo al cliente cuando se crea el token. Según la <a href="https://github.com/anexia-it/django-rest-passwordreset#example-for-sending-an-e-mail">documentación</a> de la app, se puede lograr configurando una de la siguiente forma:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">django.dispatch</span><span class="w"> </span><span class="kn">import</span> <span class="n">receiver</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django_rest_passwordreset.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">reset_password_token_created</span>

<span class="c1">#...</span>

<span class="nd">@receiver</span><span class="p">(</span><span class="n">reset_password_token_created</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">password_reset_token_created</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">reset_password_token</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Aquí deberíamos mandar un correo al cliente...</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Recupera la contraseña del correo &#39;</span><span class="si">{</span><span class="n">reset_password_token</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="si">}</span><span class="s2">&#39; usando el token &#39;</span><span class="si">{</span><span class="n">reset_password_token</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; desde la API http://localhost:8000/api/auth/reset/confirm/.&quot;&quot;)</span>
</code></pre></div>
<p>Con esto es suficiente para probar la funcionalidad, probad de nuevo a recuperar la contraseña <code>http://localhost:8000/api/auth/reset/</code> y veréis el mensaje por la terminal del servidor:</p>
<div class="highlight"><pre><span></span><code>Recupera la contraseña del correo test@test.com desde la API `http://localhost:8000/api/auth/reset/confirm/` usando el token 73538969130d6e9d4a6299a343d512af15b8.
</code></pre></div>
<p>A través del enlace a la API podemos acceder al formulario, escribir el token con la nueva contraseña y debería hacernos el cambio. Eso sí, tened en cuenta que el validador de esta app es más exigente y si la contraseña no es bastante segura nos la tumbará devolviendo varios errores:</p>
<div class="highlight"><pre><span></span><code>Contraseña: Test1234
Token: 73538969130d6e9d4a6299a343d512af15b8
</code></pre></div>
<p>Con esto tenemos la funcionalidad cubierta, sólo faltaría configurar un cliente de correo en Django y pulir la señal para enviar emails en lugar de mostrar ese <strong>print</strong> en la terminal.</p>
<h2 id="peticiones-cors">Peticiones CORS<a class="headerlink" href="#peticiones-cors" title="Permanent link">&para;</a></h2>
<p>Al acceder a la API desde un cliente web, tal como la tenemos ahora, se nos responderá con este error:</p>
<div class="highlight"><pre><span></span><code>Access to XMLHttpRequest at &#39;http://localhost:8000/api/auth/login/&#39; from origin &#39;http://localhost:3000&#39; has been blocked by CORS policy: Response to preflight request doesn&#39;t pass access control check: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource.
</code></pre></div>
<p>El error <strong>Access-Control-Allow-Origin</strong> indica que se ha bloqueado la petición por ser de tipo CORS (Cross Origin Resource Sharing). Esto sucede porque Django no permite peticiones desde distinto hosts y esto es algo que afecta tanto al dominio como al puerto. Al correr Django en el 8000 y el cliente React en el 3000, los toma como dos hosts diferentes y salta el error.</p>
<p>Para solucionar este problema tenemos que activar estas peticiones CORS y lo vamos a hacer gracias a una app externa que facilita mucho la configuración:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>server
pipenv<span class="w"> </span>install<span class="w"> </span>django-cors-headers
</code></pre></div>
<p>La activamos:</p>
<p><strong><code>mispelis/server/settings.py</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ...</span>

    <span class="c1"># Django external apps</span>
    <span class="s1">&#39;corsheaders&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rest_framework&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django_rest_passwordreset&#39;</span><span class="p">,</span>

    <span class="c1"># ...</span>
<span class="p">]</span>
</code></pre></div>
<p>La <a href="https://github.com/adamchainz/django-cors-headers">documentación oficial</a> explica que tenemos que configurar un middleware con preferencia, el cuál se encargará de procesar las peticiones CORS:</p>
<div class="highlight"><pre><span></span><code><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;corsheaders.middleware.CorsMiddleware&#39;</span><span class="p">,</span>
    <span class="c1"># ...</span>
<span class="p">]</span>
</code></pre></div>
<p>Finalmente hay que añadir los dominios que queremos permitir en las peticiones CORS, en nuestro caso el de la URL del cliente:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Configuración de CORS</span>
<span class="n">CORS_ORIGIN_WHITELIST</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;http://localhost:3000&quot;</span><span class="p">]</span>
</code></pre></div>
<p>Si probamos de nuevo nos devolverá un error diferent al anterior:</p>
<div class="highlight"><pre><span></span><code>Access to XMLHttpRequest at &#39;http://localhost:8000/api/auth/login/&#39; from origin &#39;http://localhost:3000&#39; has been blocked by CORS policy: The value of the &#39;Access-Control-Allow-Credentials&#39; header in the response is &#39;&#39; which must be &#39;true&#39; when the request&#39;s credentials mode is &#39;include&#39;. The credentials mode of requests initiated by the XMLHttpRequest is controlled by the withCredentials attribute.
</code></pre></div>
<p>El error ahora se llama <strong>'Access-Control-Allow-Credentials'</strong> y nos pide quye se puedan gestionar las credenciales de la sesión en las cabeceras de las peticiones CORS. Hacerlo es tan fácil como añadir una simple línea:</p>
<div class="highlight"><pre><span></span><code><span class="n">CORS_ALLOW_CREDENTIALS</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
<p>Debido a que estamos usando un sistema de autenticación clásico de Django, éste espera que el cliente maneje las credenciales con el atributo <strong>withCredentials</strong> en las peticiones, tal como indicaba la parte final del error:</p>
<div class="highlight"><pre><span></span><code>The credentials mode of requests initiated by the XMLHttpRequest is controlled by the withCredentials attribute.
</code></pre></div>
<p>Tampoco debemos olvidar que <strong>Django</strong> implementa un sistema de seguridad contra exploits <strong>CSRF</strong> (Cross-Site Request Forgery), por lo que en las peticiones se espera recibir de vuelta una cookie con el <strong>csrftoken</strong>, pero eso es algo que se configura en el cliente. Si queréis saber más sobre esta vulernabilidad <a href="https://es.wikipedia.org/wiki/Cross-site_request_forgery">os dejo este enlace</a>.</p>
<p>Sea como sea ya tenemos la configuración lista para la mayor parte del desarrollo.</p>
<hr />
<p><small class="edited"><i>Última edición: 19 de Marzo de 2021</i></small></p>
                  
                    
                  
                
                
                  


                
              </article>
            </div>
          </div>
        </main>
        
          
<footer class="md-footer">
  
  <div class="md-footer-nav">
    <nav class="md-footer-nav__inner md-grid">
      
      <a
        href="../"
        title="Introducción"
        class="md-flex md-footer-nav__link md-footer-nav__link--prev"
        rel="prev"
      >
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
        </div>
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Anterior
            </span>
            Introducción
          </span>
        </div>
      </a>
       
      <a
        href="../sistema-peliculas-generos/"
        title="Sistema de películas"
        class="md-flex md-footer-nav__link md-footer-nav__link--next"
        rel="next"
      >
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Siguiente
            </span>
            Sistema de películas
          </span>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
        </div>
      </a>
      
    </nav>
  </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <!--<div class="md-footer-links__highlight">
          <a href="/comunidad/">Comunidad</a> · <a href="/politica-de-cookies/">Política de cookies</a> · <a href="/sobre-mi/">Sobre mí</a>
        </div>-->
        <div class="md-footer-copyright__highlight">
          2015 - 2022 &copy; Héctor Costa Guzmán (<u
            ><a
              href="https://creativecommons.org/licenses/by/4.0/deed.es"
              target="_blank"
              rel="nofollow"
              >Licencia CC BY 4.0</a
            ></u
          >)
        </div>
      </div>
       
<style>.md-footer-social__link {transition: 0.3s;}</style>
<div class="md-footer-social" style="font-size: 2.5rem; margin-top: -6px!important; padding: 0px!important; margin-bottom: -6px; overflow: hidden!important;">
  <a href="https://github.com/hcosta" title="Github" target="_blank" class="md-footer-social__link fa fa-github-square"></a>
  &nbsp;
</div>
 
    </div>
  </div>
  <script>
    (function (i, s, o, g, r, a, m) {
      i["GoogleAnalyticsObject"] = r;
      (i[r] =
        i[r] ||
        function () {
          (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
      (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m);
    })(
      window,
      document,
      "script",
      "https://www.google-analytics.com/analytics.js",
      "ga"
    );
    ga("create", "UA-124845547-1", "auto");
    ga("send", "pageview");
  </script>
</footer>
        
        <a id="anchorID" href="https://www.hektorprofe.net/" target="_blank"></a>
      </div>
      <script type='text/javascript'
              src="https://hektorprofe.github.io/docs/assets/javascripts/application.a26c1c21.js"></script>
      <script src="https://hektorprofe.github.io/docs/assets/javascripts/tingle.min.js"></script>
      <script type='text/javascript'>
    app.initialize({version:"1.2.3",url:{base:"../../.."}})
    var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoad=e()}(this,function(){"use strict";function t(t,e,n){var o=e._settings;!n&&i(t)||(C(o.callback_enter,t),R.indexOf(t.tagName)>-1&&(N(t,e),I(t,o.class_loading)),E(t,e),a(t),C(o.callback_set,t))}var e={elements_selector:"img",container:document,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,callback_load:null,callback_error:null,callback_set:null,callback_enter:null,callback_finish:null,to_webp:!1},n=function(t){return _extends({},e,t)},o=function(t,e){return t.getAttribute("data-"+e)},r=function(t,e,n){var o="data-"+e;null!==n?t.setAttribute(o,n):t.removeAttribute(o)},a=function(t){return r(t,"was-processed","true")},i=function(t){return"true"===o(t,"was-processed")},s=function(t,e){return r(t,"ll-timeout",e)},c=function(t){return o(t,"ll-timeout")},l=function(t){return t.filter(function(t){return!i(t)})},u=function(t,e){return t.filter(function(t){return t!==e})},d=function(t,e){var n,o=new t(e);try{n=new CustomEvent("LazyLoad::Initialized",{detail:{instance:o}})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:o})}window.dispatchEvent(n)},f=function(t,e){return e?t.replace(/\.(jpe?g|png)/gi,".webp"):t},_="undefined"!=typeof window,v=_&&!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),g=_&&"IntersectionObserver"in window,h=_&&"classList"in document.createElement("p"),b=_&&function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),m=function(t,e,n,r){for(var a,i=0;a=t.children[i];i+=1)if("SOURCE"===a.tagName){var s=o(a,n);p(a,e,s,r)}},p=function(t,e,n,o){n&&t.setAttribute(e,f(n,o))},y=function(t,e){var n=b&&e.to_webp,r=o(t,e.data_src),a=o(t,e.data_bg);if(r){var i=f(r,n);t.style.backgroundImage='url("'+i+'")'}if(a){var s=f(a,n);t.style.backgroundImage=s}},w={IMG:function(t,e){var n=b&&e.to_webp,r=e.data_srcset,a=t.parentNode;a&&"PICTURE"===a.tagName&&m(a,"srcset",r,n);var i=o(t,e.data_sizes);p(t,"sizes",i);var s=o(t,r);p(t,"srcset",s,n);var c=o(t,e.data_src);p(t,"src",c,n)},IFRAME:function(t,e){var n=o(t,e.data_src);p(t,"src",n)},VIDEO:function(t,e){var n=e.data_src,r=o(t,n);m(t,"src",n),p(t,"src",r),t.load()}},E=function(t,e){var n=e._settings,o=t.tagName,r=w[o];if(r)return r(t,n),e._updateLoadingCount(1),void(e._elements=u(e._elements,t));y(t,n)},I=function(t,e){h?t.classList.add(e):t.className+=(t.className?" ":"")+e},L=function(t,e){h?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},C=function(t,e){t&&t(e)},O=function(t,e,n){t.addEventListener(e,n)},k=function(t,e,n){t.removeEventListener(e,n)},x=function(t,e,n){O(t,"load",e),O(t,"loadeddata",e),O(t,"error",n)},A=function(t,e,n){k(t,"load",e),k(t,"loadeddata",e),k(t,"error",n)},z=function(t,e,n){var o=n._settings,r=e?o.class_loaded:o.class_error,a=e?o.callback_load:o.callback_error,i=t.target;L(i,o.class_loading),I(i,r),C(a,i),n._updateLoadingCount(-1)},N=function(t,e){var n=function n(r){z(r,!0,e),A(t,n,o)},o=function o(r){z(r,!1,e),A(t,n,o)};x(t,n,o)},R=["IMG","IFRAME","VIDEO"],S=function(e,n,o){t(e,o),n.unobserve(e)},M=function(t){var e=c(t);e&&(clearTimeout(e),s(t,null))},j=function(t,e,n){var o=n._settings.load_delay,r=c(t);r||(r=setTimeout(function(){S(t,e,n),M(t)},o),s(t,r))},D=function(t){return t.isIntersecting||t.intersectionRatio>0},T=function(t){return{root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}},U=function(t,e){this._settings=n(t),this._setObserver(),this._loadingCount=0,this.update(e)};return U.prototype={_manageIntersection:function(t){var e=this._observer,n=this._settings.load_delay,o=t.target;n?D(t)?j(o,e,this):M(o):D(t)&&S(o,e,this)},_onIntersection:function(t){t.forEach(this._manageIntersection.bind(this))},_setObserver:function(){g&&(this._observer=new IntersectionObserver(this._onIntersection.bind(this),T(this._settings)))},_updateLoadingCount:function(t){this._loadingCount+=t,0===this._elements.length&&0===this._loadingCount&&C(this._settings.callback_finish)},update:function(t){var e=this,n=this._settings,o=t||n.container.querySelectorAll(n.elements_selector);this._elements=l(Array.prototype.slice.call(o)),!v&&this._observer?this._elements.forEach(function(t){e._observer.observe(t)}):this.loadAll()},destroy:function(){var t=this;this._observer&&(this._elements.forEach(function(e){t._observer.unobserve(e)}),this._observer=null),this._elements=null,this._settings=null},load:function(e,n){t(e,this,n)},loadAll:function(){var t=this;this._elements.forEach(function(e){t.load(e)})}},_&&function(t,e){if(e)if(e.length)for(var n,o=0;n=e[o];o+=1)d(t,n);else d(t,e)}(U,window.lazyLoadOptions),U});
    var myLazyLoad = new LazyLoad({elements_selector: ".lazy"});
    const mdMenuItems = document.querySelectorAll('.md-nav__link');
    function doNav(){ document.getElementById("main__list").innerHTML = '<li class="md-nav__item"><a class="md-nav__link" href="/cursos/">Cursos</a></li><li class="md-nav__item"><a class="md-nav__link" href="/blog/">Blog</a></li>';}
    for (i = 0; i < mdMenuItems.length; i++) {  var item = mdMenuItems[i]; var htmlstring = item.innerHTML; htmlstring = (htmlstring.trim) ? htmlstring.trim() : htmlstring.replace(/^\s+/,''); if (htmlstring == 'Servidor de encuentro') { item.parentNode.removeChild(item);continue; }  if (htmlstring == 'Política de Cookies') { item.parentNode.removeChild(item);continue; } if (htmlstring == 'Buscador') { item.parentNode.removeChild(item); continue; } }
    try { var topPos = document.querySelector('#md__active_link').offsetTop; document.querySelector('#md__sidebar__scroll').scrollTop = topPos - 60; } catch (err) {}
      </script>
    </body>
  </html>