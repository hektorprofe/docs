<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
    
    
    

    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Dibujando el espacio 3D en OpenGL con Python">
      
      
        <link rel="canonical" href="https://docs.hektorprofe.net/opengl/05-dibujando-el-espacio-3d/">
      
      
        <meta name="author" content="Héctor Costa Guzman">
      
      <link rel="shortcut icon" href="/favicon.ico">
    
    
      
        <title>Dibujando el espacio 3D | OpenGL en Python | Hektor Profe</title>
      
    
    <link rel="stylesheet" href="../../assets/stylesheets/application.2.css">
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    
    <link rel="stylesheet" href="/assets/stylesheets/tingle.min.css">
<style>
@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("/assets/fonts/specimen/MaterialIcons-Regular.woff2") format("woff2"),url("/assets/fonts/specimen/MaterialIcons-Regular.woff") format("woff"),url("/assets/fonts/specimen/MaterialIcons-Regular.ttf") format("truetype")}
[data-md-color-primary="grey"] .md-header { background-color: #191A1D }
[data-md-color-primary="grey"] .md-tabs { background-color: #222831 }
.md-footer-nav { background-color: #222831; }
.md-footer-meta { background-color: #191A1D }
html [data-md-color-primary="grey"] .md-nav--primary .md-nav__title--site { background-color: #191A1D; }
.mini{ display: none; } .maxi{ display: block; }
.embed-container { position: relative; padding-bottom: 56.25%;height: 0; overflow: hidden; max-width: 100%; height: auto; margin-bottom: 0; } 
.embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.md-nav__link:focus, .md-nav__link:hover { color: #018dc5; }
.headerlink{ color: #018dc5 !important; }
.md-footer-links__highlight a{ color: #777 !important; }
.md-footer-links__highlight a:hover{ color: #ddd !important; }
.visible{ display: inherit !important; }
/*.md-tabs { display: none !important; }*/
.nav__btn, .nav__logo{ transition: 0.3s; }
.nav__btn:hover{ color: #aaa; }
.nav__logo:hover{ opacity:.7; }
.nav__logo {max-width: 225px !important; }
img:not([src]){visibility:hidden;}
img.click{opacity: 0.96;box-shadow:rgb(79, 82, 92) -4px 4px}
img.click:hover{opacity: 1;box-shadow:rgb(10, 172, 237) -4px 4px}
.button { background-color: #36bf2d; border: none; color: white !important; padding: 20px 0px; text-align: center; text-decoration: none; display: block; font-size: 97%; width: 100%; font-weight: bold;}
.button:hover { background-color: #4CAF50; color: white; }
.animated.delay-1dot5s {animation-delay: 1.5s;}
.md-icon--search { display:inline-block!important}
a.headerlink{ display: none !important; }
small.edited { display: block; text-align: right; }
#cookie-bar { padding: 1.8rem 1.25rem !important; background: #191A1D  !important; box-shadow:rgba(0, 0, 0, 0.2) 4px 4px 8px 8px; }
#cookie-bar-prompt-logo{ display: none !important; }
div.my-img{text-align:center;margin-top:20px}
@media (max-width: 76.1875em){ .mini{ display: block; } .maxi{ display: none;} /*.md-nav__link[for="nav-1"] { display: none; }*/ }
@media (min-width: 1599.9px){ .md-header-nav__button.md-logo img { height: 37.5px !important; width: 220px; } }
@media (min-width: 1999.9px){ .md-header-nav__button.md-logo img { height: 40px !important; width: 240px; } }
/* Rectificación footer en paginas pequeñas de altura */
@media (max-width: 1599.8px){ .md-container {height: calc(100% - 48px)} }
@media (min-width: 1599.9px){ .md-container {height: calc(100% - 53px)} }
@media (min-width: 1999.9px){ .md-container {height: calc(100% - 58px)} }
@media only screen and (max-width: 959.9px) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 960px) and (max-width: 76.1875em) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 76.1875em) { .nav__logo { display: none !important; } } 
@media only screen and (max-width: 76.1875em) { .md-sidebar--primary { left: -26.2rem;; width: 26.2rem; }  [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(26.2rem); transform: translateX(26.2rem); } [dir="rtl"] [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(-26.2rem); transform: translateX(-26.2rem); } }
@media (min-width: 1219.9px){ #home__btn { display: none !important; } #cursos__btn{ color: white !important; } [data-md-color-primary="grey"] .md-nav__link--active{ color: rgba(0, 0, 0, 0.87); text-decoration: underline !important; } }
@media (min-width: 467.9px){ #discord__btn{ display: inline-block !important; } }
@media only screen and (min-width: 60em){ .md-search__input { background-color: rgb(53, 54, 56); } .md-search__input:hover { background-color: rgb(84, 87, 93); color: white; }}
@media (max-width: 1219.9px){ .md-header-nav__title{ padding: 0 1rem; } .nav__btn {display:none;} }
@media (max-width: 875.9px){ #cookie-bar-button{ margin-top: 20px !important; }}
@media (max-width: 719.9px){ #cookie-bar { padding: 3.25rem 1.25rem; }}
@media (max-width: 512.9px){ #cookie-bar { padding: 2rem 1.25rem; }}

.tingle-modal { font-size:18px !important;}
.tingle-modal-box{ width: 80%; max-width: 1100px; }
.tingle-btn--danger{ background: darkorange !important; }
.tingle-modal-box__content { padding: 3rem 2rem 3rem 3rem;}
@media (max-width: 540px){ .tingle-modal-box{ width: auto; } }
@media (max-width: 849px){ #supermodal{ grid-template-columns:100% !important; }}

.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 275px - 60px)}
@media (max-width: 1999.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 246px - 60px);margin-right:-1px;}}
@media (max-width: 1599.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 222px - 60px)}}

</style>
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="grey" data-md-color-accent="grey">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#dibujando-el-espacio-3d-con-opengl" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header
  class="md-header"
  data-md-component="header"
  style="position: inherit !important"
>
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a
          href="/"
          title="Hektor Profe"
          class="md-header-nav__button md-logo"
          style="font-size: 0px"
        >
          <img
            src="/assets/images/logo.png"
            width="200px"
            height="35px"
            style="margin-top: -5px"
            alt="Hektor Profe"
            title="Hektor Profe"
          />
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label
          class="md-icon md-icon--menu md-header-nav__button"
          for="__drawer"
        ></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div
          class="md-flex__ellipsis md-header-nav__title"
          data-md-component="title"
          style="text-align: right"
        >
          <!-- https://fontawesome.com/v4.7.0/ -->
          <a 
            class="nav__btn" 
            href="https://www.hektorprofe.net/" 
            style="margin-left:0em;" 
            title="Cursos de Hektor Profe">
            Cursos
          </a>
          <a 
            class="nav__btn" 
            href="https://docs.hektorprofe.net/" 
            style="margin-left:1.4em;" 
            title="Documentos de Hektor Profe">
            Documentos
          </a>
          <a 
            class="nav__btn" 
            href="https://www.hektorprofe.net/portafolio/" 
            style="margin-left:1.4em;" 
            title="Portafolio de Hektor Profe">
            Portafolio
          </a>
          <a href="/"
            ><img
              class="nav__logo"
              src="/assets/images/logo.png"
              width="200px"
              height="35px"
              style="margin: 6px auto 0"
              alt="Hektor Profe"
              title="Hektor Profe"
          /></a>
        </div>
        <style>
          .md-sidebar[data-md-state="lock"] {
            top: 0rem !important;
          }
          .md-tabs {
            display: none !important;
          }
          .hde {
            display: inline-block;
          }
          .admonition.note > .superfences-tabs > label:hover,
          .headerlink {
            color: #018dc5 !important;
          }
          .admonition.info {
            font-size: 100%;
          }
          .admonition.info label {
            font-size: 91%;
          }
          .admonition.note > .admonition-title {
            display: none;
          }
          .image {
            text-align: center;
            margin-top: 25px;
          }
          .contenedor_youtube {
            position: relative !important;
            padding-bottom: 56.25% !important; /*panorámico*/
            padding-top: 0px !important;
            height: 0 !important;
            margin-top: -20px;
            margin-bottom: 25px;
          }
          .contenedor_youtube iframe {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
          }
        </style>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container" style="padding-top: 0px !important;">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list" id="top__tabs">
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
      </ul>
    </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container" style="padding-top: 8px !important;">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap" id="md__sidebar__scroll">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title" for="__drawer" style="padding:0 !important;max-height:5.5rem;"></label>
  
  <ul class="md-nav__list" id="main__list" data-md-scrollfix>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
        <!-- comprobación extra -->
         
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      Apuntes de OpenGL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Apuntes de OpenGL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../" title="Índice del archivo" class="md-nav__link">
      Índice del archivo
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../01-primeros-pasos/" title="Primeros pasos" class="md-nav__link">
      Primeros pasos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../02-graficos-primitivos/" title="Gráficos primitivos" class="md-nav__link">
      Gráficos primitivos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../03-programando-una-tortuga/" title="Tortuga y fractales" class="md-nav__link">
      Tortuga y fractales
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../04-trabajando-con-mallas/" title="Trabajando con mallas" class="md-nav__link">
      Trabajando con mallas
    </a>
  </li>

        
            
            
            

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Dibujando el espacio 3D
      </label>
    
    <a href="./" title="Dibujando el espacio 3D" class="md-nav__link md-nav__link--active" id="md__active_link">
      Dibujando el espacio 3D
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#transformaciones-de-vista" title="Transformaciones de vista" class="md-nav__link toc__link">
    Transformaciones de vista
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#moviendo-la-camara" title="Moviendo la cámara" class="md-nav__link toc__link">
    Moviendo la cámara
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rotando-la-camara" title="Rotando la cámara" class="md-nav__link toc__link">
    Rotando la cámara
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualizando-la-orientacion" title="Visualizando la orientación" class="md-nav__link toc__link">
    Visualizando la orientación
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../06-transformaciones-afines/" title="Transformaciones afines" class="md-nav__link">
      Transformaciones afines
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      
    
      
    
      
    
      
    
      
    
  </ul>
</nav>

                  </div>
                </div>
              </div>
            

            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                
                  
                    <div class="course-offer" style="margin-bottom:25px;padding:0px 10px;">
                      <a href="https://www.hektorprofe.net/cupon/python" target="_blank">
                        <img src="/cdn/assets/python.png" style="width:100%;justify-self:center;align-self:center;"/>
                      </a>
                    </div>
                  
                

                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#transformaciones-de-vista" title="Transformaciones de vista" class="md-nav__link toc__link">
    Transformaciones de vista
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#moviendo-la-camara" title="Moviendo la cámara" class="md-nav__link toc__link">
    Moviendo la cámara
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rotando-la-camara" title="Rotando la cámara" class="md-nav__link toc__link">
    Rotando la cámara
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualizando-la-orientacion" title="Visualizando la orientación" class="md-nav__link toc__link">
    Visualizando la orientación
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="dibujando-el-espacio-3d-con-opengl">Dibujando el espacio 3D con OpenGL<a class="headerlink" href="#dibujando-el-espacio-3d-con-opengl" title="Permanent link">&para;</a></h1>
<p>A partir de ahora vamos a profundizar en cómo funciona el espacio en OpenGL para producir imágenes tridimensionales. Repasaremos las tranformaciones de esenciales, cómo mover la cámara y visualizar la orientación del mundo.</p>
<p>También es un buen momento para dejar por aquí este esquema sobre el <em>pipeline de transformación</em> de los vértices (imagen tomada de <a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/perspective-and-orthographic-projection-matrix/projection-matrix-GPU-rendering-pipeline-clipping">este genial artículo de Scratch a pixel</a>):</p>
<p><img alt="" src="/cdn/opengl/img39.png" /></p>
<h2 id="transformaciones-de-vista">Transformaciones de vista<a class="headerlink" href="#transformaciones-de-vista" title="Permanent link">&para;</a></h2>
<p>En esta práctica vamos a explorar las <code>view transformations</code>, para ello partiremos de un ejemplo básico cargando el mesh de un cubo sin aplicar ninguna rectificación:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">res.App</span> <span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span> <span class="nn">res.Mesh</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">OpenGL.GL</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">OpenGL.GLU</span> <span class="kn">import</span> <span class="o">*</span>


<span class="k">class</span> <span class="nc">GLUtils</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">InitRender</span><span class="p">():</span>
        <span class="c1"># Projection</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_PROJECTION</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">gluPerspective</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="p">(</span><span class="mi">600</span> <span class="o">/</span> <span class="mi">600</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">PrepareRender</span><span class="p">():</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">GLUtils</span><span class="o">.</span><span class="n">InitRender</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">GLUtils</span><span class="o">.</span><span class="n">PrepareRender</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">OpenGLApp</span><span class="p">(</span><span class="s2">&quot;OpenGL en Python&quot;</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img40.png" /></p>
<p>Como ya comentamos anteriormente, por defecto la cámara se encuentra el eje <code>Z=0</code>, como el cubo se está dibugando en la matriz de mundo con el centro en el origen <code>(0,0,0)</code>, lo que vemos aquí es simplemente la cara del fondo del cubo, pues la cámara está justo sobre esa cara.</p>
<p>Para visualizar el cubo completo debemos aplicarle una transformación de traslación y empujarlo al fondo. Podemos establer el modo <code>modelview</code>, configurar el espacio y activar el bufer de profundidad (si queremos) y configurar la traslación con glTranslate:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GLUtils</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">InitRender</span><span class="p">():</span>

        <span class="c1"># Projection</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_PROJECTION</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">gluPerspective</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="p">(</span><span class="mi">600</span> <span class="o">/</span> <span class="mi">600</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

        <span class="c1"># Model View</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_MODELVIEW</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
        <span class="n">glEnable</span><span class="p">(</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
        <span class="c1"># Traslación de la cámara del modelo 1 hacia atrás</span>
        <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<p>Al mover la cámara del modelo <code>-1</code> unidad del mundo hacia atrás estará exactamente sobre la otra cara, la del frente del cubo:</p>
<p><img alt="" src="/cdn/opengl/img41.png" /></p>
<p>Si posicionamos la cámara a <code>-2</code> unidades, la cara frontal del cubo estará a <code>1</code> unidad de distancia de la cámara:</p>
<div class="highlight"><pre><span></span><code><span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img42.png" /></p>
<p><strong>Nota</strong>: Debemos recordar que el cubo está normalizado y cada cara mide exactamente <code>1</code> unidad del mundo.</p>
<p>En cuanto a los ejes <code>x</code> e <code>y</code> dependen de cómo hemos configurado que crezca el espacio. Por ejemplo, trasladar la cámara del modelo <code>1</code> unidad hacia arriba ocasionará que veamos solo la mitad inferior del cubo:</p>
<div class="highlight"><pre><span></span><code><span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img43.png" /></p>
<p>Si en lugar de configurar inicialmente la traslación la establecemos en cada fotograma, ésta se acumulará:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">GLUtils</span><span class="o">.</span><span class="n">PrepareRender</span><span class="p">()</span>
    <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">deltaTime</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/anim26.gif" /></p>
<p>Sin embargo, si utilizamos las instrucciones <code>glPushMatrix</code> y <code>glPopMatrix</code> antes y después de la transformación y el renderizado:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">GLUtils</span><span class="o">.</span><span class="n">PrepareRender</span><span class="p">()</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>
    <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
    <span class="n">glPopMatrix</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img43.png" /></p>
<p>Podemos insertar la matriz actual en una pila, es decir en la memoria. Metemos las matrices de transformación en la memoria, las ejecutamos y las sacamos de la memoria. Al hacerlo reiniciamos la matriz de la <code>modelview</code> para el próximo fotograma y ya no se acumulan.</p>
<p>Si intentamos dibujar dos cubos, ambos lo harán en la misma posición y no los percibiremos:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">GLUtils</span><span class="o">.</span><span class="n">PrepareRender</span><span class="p">()</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>
    <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
    <span class="n">glPopMatrix</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img43.png" /></p>
<p>Sin embargo, si reiniciamos cargamos la identidad despueés de dibujar el primer cubo (recordemos que equivale a multipliar por <code>1</code>):</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">GLUtils</span><span class="o">.</span><span class="n">PrepareRender</span><span class="p">()</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>
    <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
    <span class="n">glLoadIdentity</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
    <span class="n">glPopMatrix</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img44.png" /></p>
<p>El segundo cubo se dibujará de nuevo en el origen. Eso ya nos da la pista de que podemos modificar la posición de la subsiguiente malla si primero reiniciamos la transformación con la matriz de identidad:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">GLUtils</span><span class="o">.</span><span class="n">PrepareRender</span><span class="p">()</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>
    <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
    <span class="n">glLoadIdentity</span><span class="p">()</span>
    <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
    <span class="n">glPopMatrix</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img45.png" /></p>
<p>Exactamente lo mismo ocurrirá con las transformaciones de escalado y rotación</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">GLUtils</span><span class="o">.</span><span class="n">PrepareRender</span><span class="p">()</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>

    <span class="c1"># Cube 1: Translate - Rotate - Scale</span>
    <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">glRotated</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glScalef</span><span class="p">(</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>

    <span class="n">glLoadIdentity</span><span class="p">()</span>

    <span class="c1"># Cube 2: Translate - Rotate - Scale</span>
    <span class="n">glTranslate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">glRotated</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glScalef</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>

    <span class="n">glPopMatrix</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img46.png" /></p>
<p><strong>Nota</strong>: OpenGL lee las matrices en orden mayor de columna, por lo que las transformaciones deben ser:</p>
<ol>
<li>Traslación</li>
<li>Rotación</li>
<li>Escalado</li>
</ol>
<p>Si el sistema utilizase orden mayor de fila, las transformaciones serían en el orden inverso:</p>
<ol>
<li>Escalado</li>
<li>Rotación</li>
<li>Traslación</li>
</ol>
<p>Este concepto lo explico más en profundidad <a href="https://docs.hektorprofe.net/graficos-3d/17-matriz-de-proyeccion/#orden-mayor-de-fila-columna">en mis apuntes de renderizado 3D</a>.</p>
<h2 id="moviendo-la-camara">Moviendo la cámara<a class="headerlink" href="#moviendo-la-camara" title="Permanent link">&para;</a></h2>
<p>En esta práctica vamos a crear una clase para gestionar nuestra propia cámara. Vamos a partir del siguiente programa:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">res.App</span> <span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span> <span class="nn">res.Mesh</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">OpenGL.GL</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">OpenGL.GLU</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Projection</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_PROJECTION</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">gluPerspective</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="p">(</span><span class="mi">600</span> <span class="o">/</span> <span class="mi">600</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="c1"># Model View</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_MODELVIEW</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
        <span class="n">glEnable</span><span class="p">(</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
        <span class="c1"># Mesh Loading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
        <span class="n">glPushMatrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
        <span class="n">glPopMatrix</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">OpenGLApp</span><span class="p">(</span><span class="s2">&quot;OpenGL en Python&quot;</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
</code></pre></div>
<p>La clase cámara establecerá en cada fotograma la transformación de visualización de OpenGL. Básicamente contaremos con distintos vectores para manejar la posición y mover la cámara:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pygame</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">from</span> <span class="nn">OpenGL.GLU</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Camera</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Posición del ojo (origen)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Vectores de dirección Y, X, Z</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Dirección hacia donde mira la cámara (adelante)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">look</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span>

    <span class="k">def</span> <span class="nf">Update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deltaTime</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()</span>
        <span class="c1"># Si presionamos la letra W moveremos la cámara adelante</span>
        <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_w</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span> <span class="o">*</span> <span class="n">deltaTime</span>
        <span class="c1"># Si presionamos la letra S moveremos la cámara atrás</span>
        <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_s</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span> <span class="o">*</span> <span class="n">deltaTime</span>
        <span class="c1"># Si presionamos la letra D moveremos la cámara a la derecha</span>
        <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_d</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">*</span> <span class="n">deltaTime</span>
        <span class="c1"># Si presionamos la letra A moveremos la cámara a la izquierda</span>
        <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_a</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">*</span> <span class="n">deltaTime</span>
        <span class="c1"># Actualizamos la dirección a donde mira la cámara</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">look</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span>
        <span class="c1"># Estableceremos la transformación de visualización</span>
        <span class="c1"># https://docs.microsoft.com/eu-es/windows/win32/opengl/glulookat</span>
        <span class="n">gluLookAt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">look</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">look</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">look</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</code></pre></div>
<p>Para usar la clase creamos una instancia de <code>Camera</code> y trasladaremos la configuración del <code>model view</code> junto con la actualización de la cámara a su propio método que llamaremos cada fotograma :</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">res.Camera</span> <span class="kn">import</span> <span class="n">Camera</span>

<span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Configure the projection</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_PROJECTION</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">gluPerspective</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="p">(</span><span class="mi">600</span> <span class="o">/</span> <span class="mi">600</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="c1"># Setup the mesh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">)</span>
        <span class="c1"># Setup the camera</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">Camera</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">UpdateCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Model View</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_MODELVIEW</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
        <span class="n">glEnable</span><span class="p">(</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
        <span class="c1"># Camera Updating</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">Update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deltaTime</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UpdateCamera</span><span class="p">()</span>
        <span class="n">glPushMatrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
        <span class="n">glPopMatrix</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/anim27.gif" /></p>
<p>Listo, ya tenemos una cámara que podemos mover en tiempo real con el teclado.</p>
<h2 id="rotando-la-camara">Rotando la cámara<a class="headerlink" href="#rotando-la-camara" title="Permanent link">&para;</a></h2>
<p>Un objeto tridimensional puede rotar a partir de uno de sus tres ejes. El ángulo de rotación recibe un nombre distinto para cada eje:</p>
<ul>
<li><strong>Pitch</strong> para la rotación congelando el eje <code>X</code>.</li>
<li><strong>Yaw</strong> para la rotación congelando el eje <code>Y</code>.</li>
<li><strong>Roll</strong> para la rotación congelando el eje <code>Z</code>.</li>
</ul>
<p><img alt="" src="/cdn/opengl/img47.png" /></p>
<p>En esta práctica vamos a mapear los ángulos <em>pitch</em> y <em>yaw</em> en función del cursor del ratón para rotar la cámara en el espacio 3D, consiguiendo un efecto similar al de una cámara en primera persona.</p>
<p>Continuando con la cámara en movimiento, vamos a añadirle dos atributos para controlar los ángulos:</p>
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="mi">0</span>
<span class="bp">self</span><span class="o">.</span><span class="n">yaw</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
<p>Un tercer atributo será un Vector2 para almacenar la última posición del ratón, inicialmente estará justo en el centro de la pantalla:</p>
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector2</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</code></pre></div>
<p>Durante la actualización de la cámara recuperaremos la posición del ratón y calcularemos la diferencia respecto a la posición anterior:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deltaTime</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">mousePos</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
    <span class="n">mouseChange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">-</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector2</span><span class="p">(</span><span class="n">mousePos</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">=</span> <span class="n">mousePos</span>
</code></pre></div>
<p>Aplicando trigonometría podemos aplicar los nuevos ángulos de rotación en función de la posición del ratón, para mas detalles sobre esto <a href="https://docs.hektorprofe.net/graficos-3d/05-transformaciones-lineales/#rotacion-de-vectores">aquí dejo mis apuntes sobre rotación de vectores</a>. Una vez la tenemos aplicada al vector <code>forward</code>, recalculamos los vectores <code>right</code> y <code>up</code> mediante el producto vectorial, siempre normalizados:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span><span class="p">):</span>
    <span class="c1"># Incrementamos los ángulos de rotación</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">yaw</span> <span class="o">+=</span> <span class="n">yaw</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">+=</span> <span class="n">pitch</span>
    <span class="c1"># Aplicamos las rotaciones mediante trigonometría</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yaw</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pitch</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pitch</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yaw</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pitch</span><span class="p">))</span>
    <span class="c1"># Normalizamos el vector adelante</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">forward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
    <span class="c1"># Recalculamos el vector derecho haciendo el producto vectorial</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
    <span class="c1"># Recalculamos el vector arriba haciendo el producto vectorial</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</code></pre></div>
<p><strong>Nota</strong>: Para evitar un futuro <em>bug</em> deberíamos establecer la posición inicial del vector forward de la misma forma durante el constructor de la clase <code>Camera</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Camera</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaw</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Valor inicial del vector forward normalizado</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yaw</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pitch</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pitch</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yaw</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pitch</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</code></pre></div>
<p>Ya podremos llamar al método después de actualizar la última posición del ratón:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deltaTime</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">mousePos</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
    <span class="n">mouseChange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">-</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector2</span><span class="p">(</span><span class="n">mousePos</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">=</span> <span class="n">mousePos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Rotate</span><span class="p">(</span><span class="n">mouseChange</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mouseChange</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</code></pre></div>
<p>En este punto si queremos que al movernos horizontalmente la rotación sea acorde con el ratón debemos negar el ángulo <code>X</code>, también podemos reducir la sensibilidad del mouse usando un <code>deltaTime</code> por una cantidad de unidades del mundo por segundo:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Camera</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mouseSensitivity</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deltaTime</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rotate</span><span class="p">(</span>
            <span class="o">-</span><span class="n">mouseChange</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mouseSensitivity</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">deltaTime</span><span class="p">,</span>
             <span class="n">mouseChange</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mouseSensitivity</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">deltaTime</span><span class="p">)</span>
</code></pre></div>
<p>Podemos añadir una rectificación al ángulo <code>pitch</code> para establecer un ángulo mínimo y máximo y no permitir una rotación vertical sobre el propio eje <code>X</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span><span class="p">):</span>
    <span class="c1"># Incrementamos los ángulos de rotación</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">+=</span> <span class="n">pitch</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">yaw</span> <span class="o">+=</span> <span class="n">yaw</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">&gt;</span> <span class="mf">89.0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="mi">89</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">89.0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="o">-</span><span class="mi">89</span>
</code></pre></div>
<p>En este punto si salimos del espacio de la ventana la rotación dejará de funcionar, podemos establecer la configuración de PyGame para que el ratón se quede dentro, además podemos esconderlo:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Configure Window</span>
        <span class="n">pg</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set_grab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>Esto implicará que no se pueda clicar el botón de salir, podemos implementar que mediante la tecla <code>ESC</code> se cierre el juego en <code>App</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pg</span><span class="o">.</span><span class="n">QUIT</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">KEYDOWN</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">K_ESCAPE</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</code></pre></div>
<p>En este punto la cámara funcionará bastante bien:</p>
<p><img alt="" src="/cdn/opengl/anim28.gif" /></p>
<p>Lamentablemente seguimos limitados por el espacio de la ventana y no podemos seguir rotando la vista, debemos encontrar una forma de solucionarlo.</p>
<p>Lo que haremos es que la cámara sea consciente del tamaño de la ventana y reinicie la posición del ratón justo al centro después de mover el ratón en cada fotograma. Luego actualizaremos la última posición, pero en lugar de la posición inicial utilizaremos la que hemos establecido en medio de la pantalla:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">UpdateCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Camera Updating</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">Update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deltaTime</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenWidth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenHeight</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deltaTime</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">screenWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">screenHeight</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">mousePos</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
    <span class="n">mouseChange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">-</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector2</span><span class="p">(</span><span class="n">mousePos</span><span class="p">)</span>
    <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">screenWidth</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">screenHeight</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># &lt;-----</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>              <span class="c1"># &lt;-----</span>
</code></pre></div>
<p>Ahora ya podemos rotar indefinidamente la cámara:</p>
<p><img alt="" src="/cdn/opengl/anim29.gif" /></p>
<p>Solo nos falta encontrar una forma de alternar si queremos mover/rotar la cámara o no. Para mí la mejor forma de hacerlo es cuando el clic derecho del ratón está clicado. Quitaremos que el ratón desaparezca inicialmente y en su lugar detectaremos el clic derecho para activar el modo <code>grab</code> y ratón invisible:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOUSEBUTTONDOWN</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set_grab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOUSEBUTTONUP</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set_grab</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>Notar que reiniciaremos la posición al centro de la pantalla antes y después de dejar clicado el botón, eso suavizará la transición entre el modo "movimiento" y el normal.</p>
<p>Simplemente haremos una comprobación a nivel del <code>Camera.Update</code>, inidicándole que sólo actualice la rotación si éste no es visible:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deltaTime</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">screenWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">screenHeight</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>

        <span class="c1"># Procesamiento de la dirección</span>
        <span class="n">mouseChange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">-</span> <span class="n">pg</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">Vector2</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_pos</span><span class="p">())</span>
        <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rotate</span><span class="p">(</span><span class="o">-</span><span class="n">mouseChange</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mouseSensitivity</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">deltaTime</span><span class="p">,</span>
                    <span class="n">mouseChange</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mouseSensitivity</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">deltaTime</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastMouse</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>

    <span class="c1"># Precesamiento del movimiento</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_pressed</span><span class="p">()</span>
    <span class="c1"># Si presionamos la letra W moveremos la cámara adelante</span>
    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_w</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span> <span class="o">*</span> <span class="n">deltaTime</span>
    <span class="c1"># Si presionamos la letra S moveremos la cámara atrás</span>
    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_s</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span> <span class="o">*</span> <span class="n">deltaTime</span>
    <span class="c1"># Si presionamos la letra D moveremos la cámara a la derecha</span>
    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_d</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">*</span> <span class="n">deltaTime</span>
    <span class="c1"># Si presionamos la letra A moveremos la cámara a la izquierda</span>
    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_a</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">*</span> <span class="n">deltaTime</span>
    <span class="c1"># Si presionamos el espacio moveremos la cámara hacia arriba</span>
    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">*</span> <span class="n">deltaTime</span>
    <span class="c1"># Si presionamos el ALT izquierdo moveremos la cámara abajo</span>
    <span class="k">if</span> <span class="n">keys</span><span class="p">[</span><span class="n">pg</span><span class="o">.</span><span class="n">K_LALT</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">*</span> <span class="n">deltaTime</span>

    <span class="c1"># Actualizamos la dirección a donde mira la cámara</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">look</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span>
    <span class="c1"># Estableceremos la transformación de visualización</span>
    <span class="c1"># https://docs.microsoft.com/eu-es/windows/win32/opengl/glulookat</span>
    <span class="n">gluLookAt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">look</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">look</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">look</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</code></pre></div>
<p>El resultado será simplemente perfecto:</p>
<p><img alt="" src="/cdn/opengl/anim30.gif" /></p>
<h2 id="visualizando-la-orientacion">Visualizando la orientación<a class="headerlink" href="#visualizando-la-orientacion" title="Permanent link">&para;</a></h2>
<p>En esta práctica vamos a dibujar unas líneas representando el punto de origen del mundo tridimensional y sus vectores con dirección arriba, derecha y adelante.</p>
<p>Utilizaremos como base el programa anterior:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pygame</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">from</span> <span class="nn">pygame.locals</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">res.App</span> <span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span> <span class="nn">res.Camera</span> <span class="kn">import</span> <span class="n">Camera</span>
<span class="kn">from</span> <span class="nn">res.Mesh</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">OpenGL.GL</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">OpenGL.GLU</span> <span class="kn">import</span> <span class="o">*</span>


<span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">Init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Configure the projection</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_PROJECTION</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">gluPerspective</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="p">(</span><span class="mi">600</span> <span class="o">/</span> <span class="mi">600</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="c1"># Setup the mesh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../res/models/cube.obj&quot;</span><span class="p">)</span>
        <span class="c1"># Setup the camera</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">Camera</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">Inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOUSEBUTTONDOWN</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set_grab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOUSEBUTTONUP</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">mouse</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set_grab</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">UpdateCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Model View</span>
        <span class="n">glMatrixMode</span><span class="p">(</span><span class="n">GL_MODELVIEW</span><span class="p">)</span>
        <span class="n">glLoadIdentity</span><span class="p">()</span>
        <span class="n">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
        <span class="n">glEnable</span><span class="p">(</span><span class="n">GL_DEPTH_TEST</span><span class="p">)</span>
        <span class="c1"># Camera Updating</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">Update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deltaTime</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenWidth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenHeight</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UpdateCamera</span><span class="p">()</span>
        <span class="n">glPushMatrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
        <span class="n">glPopMatrix</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">OpenGLApp</span><span class="p">(</span><span class="s2">&quot;OpenGL en Python&quot;</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
</code></pre></div>
<p>Empecemos dibujando unas líneas para representar los ejes <code>x</code>, <code>y</code>, <code>z</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OpenGLApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">DrawWorldAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glLineWidth</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">glBegin</span><span class="p">(</span><span class="n">GL_LINES</span><span class="p">)</span>
        <span class="n">glVertex3d</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># X Axis</span>
        <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Y Axis</span>
        <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">)</span> <span class="c1"># Z Axis</span>
        <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">glEnd</span><span class="p">()</span>
        <span class="n">glLineWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="n">GL_DEPTH_BUFFER_BIT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawWorldAxes</span><span class="p">()</span> <span class="c1"># &lt;-----</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UpdateCamera</span><span class="p">()</span>
        <span class="n">glPushMatrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
        <span class="n">glPopMatrix</span><span class="p">()</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img48.png" /></p>
<p>Podemos hacerlas de distintos colores:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">DrawWorldAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">glLineWidth</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">glBegin</span><span class="p">(</span><span class="n">GL_LINES</span><span class="p">)</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># X Axis</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Y Axis</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Z Axis</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">glEnd</span><span class="p">()</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">glLineWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="/cdn/opengl/img49.png" /></p>
<p>Ahora podemos dibujar en la longitud <code>1</code> de cada eje una esfera. Para ello crearemos un objeto cuádrico de OpenGL. De paso modificaremos la longitud de las líneas a una sola unidad:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">DrawWorldAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="c1"># Dibujamos las líneas para los ejes</span>
    <span class="n">glLineWidth</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">glBegin</span><span class="p">(</span><span class="n">GL_LINES</span><span class="p">)</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Eje X</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Eje Y</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Eje Z</span>
    <span class="n">glVertex3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">glEnd</span><span class="p">()</span>

    <span class="c1"># Creamos un objeto cuádrico en OpenGL para una esfera</span>
    <span class="c1"># https://docs.microsoft.com/es-es/windows/win32/opengl/glunewquadric</span>
    <span class="n">sphere</span> <span class="o">=</span> <span class="n">gluNewQuadric</span><span class="p">()</span>

    <span class="c1"># Dibujamos una esfera para el eje X</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>
    <span class="n">glTranslated</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">gluSphere</span><span class="p">(</span><span class="n">sphere</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">glPopMatrix</span><span class="p">()</span>

    <span class="c1"># Dibujamos una esfera para el eje Y</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>
    <span class="n">glTranslated</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">gluSphere</span><span class="p">(</span><span class="n">sphere</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">glPopMatrix</span><span class="p">()</span>

    <span class="c1"># Dibujamos una esfera para el eje Z</span>
    <span class="n">glColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">glPushMatrix</span><span class="p">()</span>
    <span class="n">glTranslated</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">gluSphere</span><span class="p">(</span><span class="n">sphere</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">glPopMatrix</span><span class="p">()</span>

    <span class="n">glColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">glLineWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>Si modificamos el ángulo inicial <code>yaw</code> a <code>-90</code> para alinear la cámara con el origen para el eje <code>x</code> moviéndonos hacia atrás veremos los ejes del cubo en el mundo en el punto de origen:</p>
<p><img alt="" src="/cdn/opengl/img50.png" /></p>
<hr />
<p><small class="edited"><i>Última edición: 3 de Octubre de 2022</i></small></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-nav">
    <nav class="md-footer-nav__inner md-grid">
      
      <a
        href="../04-trabajando-con-mallas/"
        title="Trabajando con mallas"
        class="md-flex md-footer-nav__link md-footer-nav__link--prev"
        rel="prev"
      >
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
        </div>
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Anterior
            </span>
            Trabajando con mallas
          </span>
        </div>
      </a>
       
      <a
        href="../06-transformaciones-afines/"
        title="Transformaciones afines"
        class="md-flex md-footer-nav__link md-footer-nav__link--next"
        rel="next"
      >
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Siguiente
            </span>
            Transformaciones afines
          </span>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
        </div>
      </a>
      
    </nav>
  </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <!--<div class="md-footer-links__highlight">
          <a href="/comunidad/">Comunidad</a> · <a href="/politica-de-cookies/">Política de cookies</a> · <a href="/sobre-mi/">Sobre mí</a>
        </div>-->
        <div class="md-footer-copyright__highlight">
          2015 - 2022 &copy; Héctor Costa Guzmán (<u
            ><a
              href="https://creativecommons.org/licenses/by/4.0/deed.es"
              target="_blank"
              rel="nofollow"
              >Licencia CC BY 4.0</a
            ></u
          >)
        </div>
      </div>
       
<style>.md-footer-social__link {transition: 0.3s;}</style>
<div class="md-footer-social" style="font-size: 2.5rem; margin-top: -6px!important; padding: 0px!important; margin-bottom: -6px; overflow: hidden!important;">
  <a href="https://github.com/hcosta" title="Github" target="_blank" class="md-footer-social__link fa fa-github-square"></a>
  <a href="https://www.youtube.com/c/HektorProfe" title="Youtube" target="_blank" class="md-footer-social__link fa fa-youtube-square"></a>
  &nbsp;
</div>
 
    </div>
  </div>
  <script>
    (function (i, s, o, g, r, a, m) {
      i["GoogleAnalyticsObject"] = r;
      (i[r] =
        i[r] ||
        function () {
          (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
      (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m);
    })(
      window,
      document,
      "script",
      "https://www.google-analytics.com/analytics.js",
      "ga"
    );
    ga("create", "UA-124845547-1", "auto");
    ga("send", "pageview");
  </script>
</footer>
      
      <a id="anchorID" href="https://www.hektorprofe.net/" target="_blank"></a>
    </div>
  <script type='text/javascript' src="/assets/javascripts/application.a26c1c21.js"></script>
  <script src="/assets/javascripts/tingle.min.js"></script>
  <script type='text/javascript'>
    var modalButtonOnly = new tingle.modal({
        closeMethods: [],
        footer: true,
        stickyFooter: true
    });
    var btn5 = document.querySelector('.js-tingle-modal-5');

    // set content
    modalButtonOnly.setContent(`
    <div style="display:grid;grid-template-columns:32% 32% 32%;grid-column-gap: 1.33%;" id="supermodal">
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/python" target="_blank"><img src="/cdn/assets/python.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/django" target="_blank"><img src="/cdn/assets/django.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/pyside" target="_blank"><img src="/cdn/assets/pyside.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
    </div>`);

    modalButtonOnly.addFooterBtn('Cerrar', 'tingle-btn tingle-btn--default tingle-btn--pull-right', function(){
      modalButtonOnly.close();
    });

    app.initialize({version:"1.2.3",url:{base:"../.."}})
    var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoad=e()}(this,function(){"use strict";function t(t,e,n){var o=e._settings;!n&&i(t)||(C(o.callback_enter,t),R.indexOf(t.tagName)>-1&&(N(t,e),I(t,o.class_loading)),E(t,e),a(t),C(o.callback_set,t))}var e={elements_selector:"img",container:document,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,callback_load:null,callback_error:null,callback_set:null,callback_enter:null,callback_finish:null,to_webp:!1},n=function(t){return _extends({},e,t)},o=function(t,e){return t.getAttribute("data-"+e)},r=function(t,e,n){var o="data-"+e;null!==n?t.setAttribute(o,n):t.removeAttribute(o)},a=function(t){return r(t,"was-processed","true")},i=function(t){return"true"===o(t,"was-processed")},s=function(t,e){return r(t,"ll-timeout",e)},c=function(t){return o(t,"ll-timeout")},l=function(t){return t.filter(function(t){return!i(t)})},u=function(t,e){return t.filter(function(t){return t!==e})},d=function(t,e){var n,o=new t(e);try{n=new CustomEvent("LazyLoad::Initialized",{detail:{instance:o}})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:o})}window.dispatchEvent(n)},f=function(t,e){return e?t.replace(/\.(jpe?g|png)/gi,".webp"):t},_="undefined"!=typeof window,v=_&&!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),g=_&&"IntersectionObserver"in window,h=_&&"classList"in document.createElement("p"),b=_&&function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),m=function(t,e,n,r){for(var a,i=0;a=t.children[i];i+=1)if("SOURCE"===a.tagName){var s=o(a,n);p(a,e,s,r)}},p=function(t,e,n,o){n&&t.setAttribute(e,f(n,o))},y=function(t,e){var n=b&&e.to_webp,r=o(t,e.data_src),a=o(t,e.data_bg);if(r){var i=f(r,n);t.style.backgroundImage='url("'+i+'")'}if(a){var s=f(a,n);t.style.backgroundImage=s}},w={IMG:function(t,e){var n=b&&e.to_webp,r=e.data_srcset,a=t.parentNode;a&&"PICTURE"===a.tagName&&m(a,"srcset",r,n);var i=o(t,e.data_sizes);p(t,"sizes",i);var s=o(t,r);p(t,"srcset",s,n);var c=o(t,e.data_src);p(t,"src",c,n)},IFRAME:function(t,e){var n=o(t,e.data_src);p(t,"src",n)},VIDEO:function(t,e){var n=e.data_src,r=o(t,n);m(t,"src",n),p(t,"src",r),t.load()}},E=function(t,e){var n=e._settings,o=t.tagName,r=w[o];if(r)return r(t,n),e._updateLoadingCount(1),void(e._elements=u(e._elements,t));y(t,n)},I=function(t,e){h?t.classList.add(e):t.className+=(t.className?" ":"")+e},L=function(t,e){h?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},C=function(t,e){t&&t(e)},O=function(t,e,n){t.addEventListener(e,n)},k=function(t,e,n){t.removeEventListener(e,n)},x=function(t,e,n){O(t,"load",e),O(t,"loadeddata",e),O(t,"error",n)},A=function(t,e,n){k(t,"load",e),k(t,"loadeddata",e),k(t,"error",n)},z=function(t,e,n){var o=n._settings,r=e?o.class_loaded:o.class_error,a=e?o.callback_load:o.callback_error,i=t.target;L(i,o.class_loading),I(i,r),C(a,i),n._updateLoadingCount(-1)},N=function(t,e){var n=function n(r){z(r,!0,e),A(t,n,o)},o=function o(r){z(r,!1,e),A(t,n,o)};x(t,n,o)},R=["IMG","IFRAME","VIDEO"],S=function(e,n,o){t(e,o),n.unobserve(e)},M=function(t){var e=c(t);e&&(clearTimeout(e),s(t,null))},j=function(t,e,n){var o=n._settings.load_delay,r=c(t);r||(r=setTimeout(function(){S(t,e,n),M(t)},o),s(t,r))},D=function(t){return t.isIntersecting||t.intersectionRatio>0},T=function(t){return{root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}},U=function(t,e){this._settings=n(t),this._setObserver(),this._loadingCount=0,this.update(e)};return U.prototype={_manageIntersection:function(t){var e=this._observer,n=this._settings.load_delay,o=t.target;n?D(t)?j(o,e,this):M(o):D(t)&&S(o,e,this)},_onIntersection:function(t){t.forEach(this._manageIntersection.bind(this))},_setObserver:function(){g&&(this._observer=new IntersectionObserver(this._onIntersection.bind(this),T(this._settings)))},_updateLoadingCount:function(t){this._loadingCount+=t,0===this._elements.length&&0===this._loadingCount&&C(this._settings.callback_finish)},update:function(t){var e=this,n=this._settings,o=t||n.container.querySelectorAll(n.elements_selector);this._elements=l(Array.prototype.slice.call(o)),!v&&this._observer?this._elements.forEach(function(t){e._observer.observe(t)}):this.loadAll()},destroy:function(){var t=this;this._observer&&(this._elements.forEach(function(e){t._observer.unobserve(e)}),this._observer=null),this._elements=null,this._settings=null},load:function(e,n){t(e,this,n)},loadAll:function(){var t=this;this._elements.forEach(function(e){t.load(e)})}},_&&function(t,e){if(e)if(e.length)for(var n,o=0;n=e[o];o+=1)d(t,n);else d(t,e)}(U,window.lazyLoadOptions),U});
    var myLazyLoad = new LazyLoad({elements_selector: ".lazy"});
    const mdMenuItems = document.querySelectorAll('.md-nav__link');
    function doNav(){ document.getElementById("main__list").innerHTML = '<li class="md-nav__item"><a class="md-nav__link" href="/cursos/">Cursos</a></li><li class="md-nav__item"><a class="md-nav__link" href="/blog/">Blog</a></li>';}
    for (i = 0; i < mdMenuItems.length; i++) {  var item = mdMenuItems[i]; var htmlstring = item.innerHTML; htmlstring = (htmlstring.trim) ? htmlstring.trim() : htmlstring.replace(/^\s+/,''); if (htmlstring == 'Servidor de encuentro') { item.parentNode.removeChild(item);continue; }  if (htmlstring == 'Política de Cookies') { item.parentNode.removeChild(item);continue; } if (htmlstring == 'Buscador') { item.parentNode.removeChild(item); continue; } }
    try { var topPos = document.querySelector('#md__active_link').offsetTop; document.querySelector('#md__sidebar__scroll').scrollTop = topPos - 60; } catch (err) {}
  </script>
  </body>
</html>