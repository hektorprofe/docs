<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
    
    
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Web de apuntes de programación de Hector Costa Guzman.">
      
      <link rel="canonical" href="https://hektorprofe.github.io/docs/graficos-3d/17-matriz-de-proyeccion/">
      
        <meta name="author" content="Héctor Costa Guzman">
      
      <link rel="shortcut icon" href="/favicon.ico">
    
    
      
        <title>Matriz de proyección | Programación de gráficos 3D | Hektor Profe</title>
      
    
    <link rel="stylesheet"
          href="../../assets/stylesheets/application.2.css">
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet"
              href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    
    <link rel="stylesheet"
          href="https://hektorprofe.github.io/docs/assets/stylesheets/tingle.min.css">
    <style>
@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("https://hektorprofe.github.io/docs/assets/fonts/specimen/MaterialIcons-Regular.woff2") format("woff2"),url("https://hektorprofe.github.io/docs/assets/fonts/specimen/MaterialIcons-Regular.woff") format("woff"),url("https://hektorprofe.github.io/docs/assets/fonts/specimen/MaterialIcons-Regular.ttf") format("truetype")}
[data-md-color-primary="grey"] .md-header { background-color: #191A1D }
[data-md-color-primary="grey"] .md-tabs { background-color: #222831 }
.md-footer-nav { background-color: #222831; }
.md-footer-meta { background-color: #191A1D }
html [data-md-color-primary="grey"] .md-nav--primary .md-nav__title--site { background-color: #191A1D; }
.mini{ display: none; } .maxi{ display: block; }
.embed-container { position: relative; padding-bottom: 56.25%;height: 0; overflow: hidden; max-width: 100%; height: auto; margin-bottom: 0; } 
.embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.md-nav__link:focus, .md-nav__link:hover { color: #018dc5; }
.headerlink{ color: #018dc5 !important; }
.md-footer-links__highlight a{ color: #777 !important; }
.md-footer-links__highlight a:hover{ color: #ddd !important; }
.visible{ display: inherit !important; }
/*.md-tabs { display: none !important; }*/
.nav__btn, .nav__logo{ transition: 0.3s; }
.nav__btn:hover{ color: #aaa; }
.nav__logo:hover{ opacity:.7; }
.nav__logo {max-width: 225px !important; }
img:not([src]){visibility:hidden;}
img.click{opacity: 0.96;box-shadow:rgb(79, 82, 92) -4px 4px}
img.click:hover{opacity: 1;box-shadow:rgb(10, 172, 237) -4px 4px}
.button { background-color: #36bf2d; border: none; color: white !important; padding: 20px 0px; text-align: center; text-decoration: none; display: block; font-size: 97%; width: 100%; font-weight: bold;}
.button:hover { background-color: #4CAF50; color: white; }
.animated.delay-1dot5s {animation-delay: 1.5s;}
.md-icon--search { display:inline-block!important}
a.headerlink{ display: none !important; }
small.edited { display: block; text-align: right; }
#cookie-bar { padding: 1.8rem 1.25rem !important; background: #191A1D  !important; box-shadow:rgba(0, 0, 0, 0.2) 4px 4px 8px 8px; }
#cookie-bar-prompt-logo{ display: none !important; }
div.my-img{text-align:center;margin-top:20px}
@media (max-width: 76.1875em){ .mini{ display: block; } .maxi{ display: none;} /*.md-nav__link[for="nav-1"] { display: none; }*/ }
@media (min-width: 1599.9px){ .md-header-nav__button.md-logo img { height: 37.5px !important; width: 220px; } }
@media (min-width: 1999.9px){ .md-header-nav__button.md-logo img { height: 40px !important; width: 240px; } }
/* Rectificación footer en paginas pequeñas de altura */
@media (max-width: 1599.8px){ .md-container {height: calc(100% - 48px)} }
@media (min-width: 1599.9px){ .md-container {height: calc(100% - 53px)} }
@media (min-width: 1999.9px){ .md-container {height: calc(100% - 58px)} }
@media only screen and (max-width: 959.9px) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 960px) and (max-width: 76.1875em) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 76.1875em) { .nav__logo { display: none !important; } } 
@media only screen and (max-width: 76.1875em) { .md-sidebar--primary { left: -26.2rem;; width: 26.2rem; }  [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(26.2rem); transform: translateX(26.2rem); } [dir="rtl"] [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(-26.2rem); transform: translateX(-26.2rem); } }
@media (min-width: 1219.9px){ #home__btn { display: none !important; } #cursos__btn{ color: white !important; } [data-md-color-primary="grey"] .md-nav__link--active{ color: rgba(0, 0, 0, 0.87); text-decoration: underline !important; } }
@media (min-width: 467.9px){ #discord__btn{ display: inline-block !important; } }
@media only screen and (min-width: 60em){ .md-search__input { background-color: rgb(53, 54, 56); } .md-search__input:hover { background-color: rgb(84, 87, 93); color: white; }}
@media (max-width: 1219.9px){ .md-header-nav__title{ padding: 0 1rem; } .nav__btn {display:none;} }
@media (max-width: 875.9px){ #cookie-bar-button{ margin-top: 20px !important; }}
@media (max-width: 719.9px){ #cookie-bar { padding: 3.25rem 1.25rem; }}
@media (max-width: 512.9px){ #cookie-bar { padding: 2rem 1.25rem; }}

.tingle-modal { font-size:18px !important;}
.tingle-modal-box{ width: 80%; max-width: 1100px; }
.tingle-btn--danger{ background: darkorange !important; }
.tingle-modal-box__content { padding: 3rem 2rem 3rem 3rem;}
@media (max-width: 540px){ .tingle-modal-box{ width: auto; } }
@media (max-width: 849px){ #supermodal{ grid-template-columns:100% !important; }}

.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 275px - 60px)}
@media (max-width: 1999.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 246px - 60px);margin-right:-1px;}}
@media (max-width: 1599.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 222px - 60px)}}

    </style>
  </head>
  
    
    
    <body dir="ltr"
          data-md-color-primary="grey"
          data-md-color-accent="grey">
    
      <input class="md-toggle"
             data-md-toggle="drawer"
             type="checkbox"
             id="__drawer"
             autocomplete="off">
      <input class="md-toggle"
             data-md-toggle="search"
             type="checkbox"
             id="__search"
             autocomplete="off">
      <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
      
        <a href="#matriz-de-proyeccion"
           tabindex="1"
           class="md-skip">Saltar a contenido</a>
      
      
        <header class="md-header"
        data-md-component="header"
        style="position: inherit !important">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="/"
           title="Hektor Profe"
           class="md-header-nav__button md-logo"
           style="font-size: 0px">
          <img src="https://hektorprofe.github.io/docs/assets/images/logo.png"
               width="200px"
               height="35px"
               style="margin-top: -5px"
               alt="Hektor Profe"
               title="Hektor Profe" />
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title"
             data-md-component="title"
             style="text-align: right">
          <!-- https://fontawesome.com/v4.7.0/ -->
          <a class="nav__btn"
             href="https://www.hektorprofe.net/"
             style="margin-left:0em"
             title="Cursos de Hektor Profe">Cursos</a>
          <a class="nav__btn"
             href="https://docs.hektorprofe.net/"
             style="margin-left:1.4em"
             title="Documentos de Hektor Profe">Documentos</a>
          <a class="nav__btn"
             href="https://www.hektorprofe.net/portafolio/"
             style="margin-left:1.4em"
             title="Portafolio de Hektor Profe">Portafolio</a>
          <a href="/">
            <img class="nav__logo"
                 src="https://hektorprofe.github.io/docs/assets/images/logo.png"
                 width="200px"
                 height="35px"
                 style="margin: 6px auto 0"
                 alt="Hektor Profe"
                 title="Hektor Profe" />
          </a>
        </div>
        <style>
          .md-sidebar[data-md-state="lock"] {
            top: 0rem !important;
          }
          .md-tabs {
            display: none !important;
          }
          .hde {
            display: inline-block;
          }
          .admonition.note > .superfences-tabs > label:hover,
          .headerlink {
            color: #018dc5 !important;
          }
          .admonition.info {
            font-size: 100%;
          }
          .admonition.info label {
            font-size: 91%;
          }
          .admonition.note > .admonition-title {
            display: none;
          }
          .image {
            text-align: center;
            margin-top: 25px;
          }
          .contenedor_youtube {
            position: relative !important;
            padding-bottom: 56.25% !important; /*panorámico*/
            padding-top: 0px !important;
            height: 0 !important;
            margin-top: -20px;
            margin-bottom: 25px;
          }
          .contenedor_youtube iframe {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
          }
        </style>
      </div>
    </div>
  </nav>
</header>
      
      <div class="md-container" style="padding-top: 0px !important;">
        
          
        
        
          

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list" id="top__tabs">
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
      </ul>
    </div>
</nav>
        
        <main class="md-main">
          <div class="md-main__inner md-grid"
               data-md-component="container"
               style="padding-top: 8px !important">
            
              
                <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                  <div class="md-sidebar__scrollwrap" id="md__sidebar__scroll">
                    <div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title" for="__drawer" style="padding:0 !important;max-height:5.5rem;"></label>
  
  <ul class="md-nav__list" id="main__list" data-md-scrollfix>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
        <!-- comprobación extra -->
         
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      Apuntes de Gráficos 3D
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Apuntes de Gráficos 3D
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../" title="Índice del archivo" class="md-nav__link">
      Índice del archivo
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../01-configuracion-previa/" title="Configuración previa" class="md-nav__link">
      Configuración previa
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../02-buffer-de-color/" title="Buffer de color" class="md-nav__link">
      Buffer de color
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../03-vectores-y-puntos/" title="Vectores y puntos" class="md-nav__link">
      Vectores y puntos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../04-proyeccion-de-puntos/" title="Proyección de puntos" class="md-nav__link">
      Proyección de puntos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../05-transformaciones-lineales/" title="Transformaciones lineales" class="md-nav__link">
      Transformaciones lineales
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../06-triangulos-vertices-mallas/" title="Triángulos, vértices y mallas" class="md-nav__link">
      Triángulos, vértices y mallas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../07-rasterizacion-de-lineas/" title="Rasterización de líneas" class="md-nav__link">
      Rasterización de líneas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../08-mallas-en-memoria-dinamica/" title="Mallas en memoria dinámica" class="md-nav__link">
      Mallas en memoria dinámica
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../09-ficheros-con-modelos-obj/" title="Ficheros con modelos OBJ" class="md-nav__link">
      Ficheros con modelos OBJ
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../10-operaciones-con-vectores/" title="Operaciones con vectores" class="md-nav__link">
      Operaciones con vectores
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../11-back-face-culling/" title="Back-face Culling" class="md-nav__link">
      Back-face Culling
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../12-rasterizacion-de-triangulos/" title="Rasterización de triángulos" class="md-nav__link">
      Rasterización de triángulos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../13-interfaz-dear-imgui/" title="Interfaz Dear ImGui" class="md-nav__link">
      Interfaz Dear ImGui
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../14-ordenar-caras-por-profundidad/" title="Ordenar caras por profundidad" class="md-nav__link">
      Ordenar caras por profundidad
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../15-operaciones-con-matrices/" title="Operaciones con matrices" class="md-nav__link">
      Operaciones con matrices
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../16-matrices-de-transformacion-3d/" title="Matrices de transformación 3D" class="md-nav__link">
      Matrices de transformación 3D
    </a>
  </li>

        
            
            
            

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Matriz de proyección
      </label>
    
    <a href="./" title="Matriz de proyección" class="md-nav__link md-nav__link--active" id="md__active_link">
      Matriz de proyección
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#proyeccion-de-valores-negativos" title="Proyección de valores negativos" class="md-nav__link toc__link">
    Proyección de valores negativos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orden-mayor-de-fila-columna" title="Orden mayor de fila-columna" class="md-nav__link toc__link">
    Orden mayor de fila-columna
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../18-luz-y-sombreado/" title="Luz y sombreado" class="md-nav__link">
      Luz y sombreado
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../19-migracion-a-visual-studio/" title="Migración a Visual Studio" class="md-nav__link">
      Migración a Visual Studio
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../20-mapeado-de-texturas/" title="Mapeado de texturas" class="md-nav__link">
      Mapeado de texturas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../21-interpolacion-de-perspectiva/" title="Interpolación de perspectiva" class="md-nav__link">
      Interpolación de perspectiva
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../22-decodificacion-de-ficheros-png/" title="Decodificación de ficheros PNG" class="md-nav__link">
      Decodificación de ficheros PNG
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../23-ficheros-obj-con-texturas/" title="Ficheros OBJ con texturas" class="md-nav__link">
      Ficheros OBJ con texturas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../24-profundidad-con-z-buffer/" title="Profundidad con Z-Buffer" class="md-nav__link">
      Profundidad con Z-Buffer
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../25-matriz-de-vista-y-camara/" title="Matriz de vista y cámaras" class="md-nav__link">
      Matriz de vista y cámaras
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../26-renderizado-y-debug-separado/" title="Renderizado y debug separado" class="md-nav__link">
      Renderizado y debug separado
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../27-clipping/" title="Clipping" class="md-nav__link">
      Clipping
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../28-multiples-mallas/" title="Múltiples mallas" class="md-nav__link">
      Múltiples mallas
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      
    
      
    
      
    
      
    
      
    
      
    
  </ul>
</nav>
</div>
                  </div>
                </div>
              
              
                <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                  <div class="md-sidebar__scrollwrap">
                    <div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#proyeccion-de-valores-negativos" title="Proyección de valores negativos" class="md-nav__link toc__link">
    Proyección de valores negativos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orden-mayor-de-fila-columna" title="Orden mayor de fila-columna" class="md-nav__link toc__link">
    Orden mayor de fila-columna
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav></div>
                  </div>
                </div>
              
            
            <div class="md-content">
              <article class="md-content__inner md-typeset">
                
                  
                  
                  <h1 id="matriz-de-proyeccion">Matriz de proyección<a class="headerlink" href="#matriz-de-proyeccion" title="Permanent link">&para;</a></h1>
<p>Otro aspecto que podemos realizar mediante matrices es la proyección del espacio 3D al espacio 2D, algo que no se limita a una proyección perspectiva, ya que con la matriz adecuada conseguiremos distintos efectos.</p>
<p>Hasta ahora para realizar una proyección utilizábamos la brecha de perspectiva, dividiendo las distancias entre la profundidad para conseguir la representación bidimensional. Esta proyección se considera "débil", ya que solo tiene en cuenta la propia brecha.</p>
<p>Lo que haremos será definir una <strong>matriz de proyección</strong> mucho más sofisticada sobre la que aplicar la brecha de perspectiva:</p>
<ul>
<li>Implementará la <strong>relación de aspecto</strong> para los valores <code>x</code> e <code>y</code> en función del ancho y alto de la pantalla.</li>
<li>Implementará la <strong>campo de visión</strong> para los valores <code>x</code> e <code>y</code> en función del ángulo <em>FOV</em>.</li>
<li>Implementará la <strong>normalización</strong> para los valores <code>x</code>, <code>y</code>, <code>z</code> entre <code>-1</code> y <code>1</code>.</li>
</ul>
<p>Al tener en cuenta todos estos parámetros, conseguiremos un cubo de valores normalizados, una <strong>imagen del espacio</strong> (<em>image space</em>) o <strong>NDC</strong> (<em>Normalized Device Coordinates</em>):</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/image-67.png" /></p>
<p>Empecemos por el principio, la <strong>relación de aspecto</strong> <code>a</code> es la relación entre la altura <code>h</code> (<em>height</em>) y anchura <code>w</code> (<em>width</em>) de la pantalla.</p>
<p>Para conseguir la conversión del espacio de mundo (<em>world space</em>) a espacio de pantalla (<em>screen space</em>) adaptaremos el ancho <code>x</code> multiplicándolo por la relación de aspecto:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex060.png" /></p>
<p>En cuanto al <strong>campo de visión</strong> nos requerirá encontrar un factor de escalado. Este lo podemos encontrar mediante la relación entre el cateto opuesto y el adjunto, es decir, la mitad de la tangente (el cateto opuesto mide la mitad):</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/image-68.png" /></p>
<p>Sin embargo encontramos una contradicción y es que cuanto mayor es el ángulo, más elementos vemos pero también serán más pequeños en la pantalla. Por contra, cuanto menor es el ángulo, menos elementos veremos pero serán más grandes en la pantalla. Por esa razón la función que buscamos es opuesta a la tangente de la mitad del ángulo:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex061.png" /></p>
<p>Lo último que necesitamos aplicar es la <strong>normalización</strong> del espacio visualizado, para ello buscaremos otro factor de escalado. Delimitaremos la profundidad del <strong>Frustum</strong> entre la <code>Z</code> más alejada <code>zfar</code> y la <code>Z</code> más cercana <code>znear</code>. </p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/image-69.png" /></p>
<p>Podemos llamar al factor de escalado simplemente <code>λ</code>, será la distancia máxima <code>zfar</code> entre la diferencia entre <code>zfar</code> y <code>znear</code>:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex062.png" /></p>
<p>Sin embargo debemos tener en cuenta el <em>offset</em> de <code>znear</code>, pues ésta no parte de cero:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex063.png" /></p>
<p>Sustraemos esa distancia inicial, la cuál conseguiremos multiplicando el factor de escalado y <code>znear</code>:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex064.png" /></p>
<p>Con esto ya tenemos los factores de la <strong>relación de aspecto</strong>, el <strong>campo de visión</strong> y la <strong>normalización de la profundidad</strong>:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex065.png" /></p>
<p>Si los aplicamos antes de la brecha de perspectiva (<code>x/z</code>, <code>y/z</code>, <code>z/z</code>) obtendremos la <strong>imagen del espacio</strong> normalizado:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/image-70.png" /></p>
<p>Si trasladamos todos los factores a nuestra matriz de referencia <code>4x4</code> conseguiremos la <strong>matriz de proyección</strong>:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex066.png" /></p>
<p>Esta es la <strong>matriz de proyección</strong> pero <strong>sin tener en cuenta la brecha de perspectiva</strong>.</p>
<p>Por cierto, veremos un número <code>1</code> en la cuarta fila y tercera columna. Al aplicar la multiplicación de matrices nos permitirá guardar el valor original de <code>Z</code> en <code>W</code>, es decir un <em>backup</em> del valor <code>Z</code> sin normalizar. Necesitaremos este valor para aplicar la brecha de perspectiva y también nos hará falta en el futuro para  realizar diferentes operaciones.</p>
<p>En cualquier caso necesitaremos implementar dos métodos en <code>Matrix4</code>, uno para definir la <strong>matriz de perspectiva</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="nf">PerspectiveMatrix</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">fov</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">aspect</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">znear</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">zfar</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// | (h/w)*1/tan(fov/2)                0             0                   0 |</span>
<span class="w">    </span><span class="c1">// |                  0     1/tan(fov/2)             0                   0 |</span>
<span class="w">    </span><span class="c1">// |                  0                0    zf/(zf/zn)    (-zf*zn)/(zf-zn) |</span>
<span class="w">    </span><span class="c1">// |                  0                0             1                   0 |</span>
<span class="w">    </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{{</span><span class="mi">0</span><span class="p">}}};</span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aspect</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">tan</span><span class="p">(</span><span class="n">fov</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">));</span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">tan</span><span class="p">(</span><span class="n">fov</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zfar</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">zfar</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">znear</span><span class="p">);</span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="n">zfar</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">znear</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">zfar</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">znear</span><span class="p">);</span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Y otro para aplicarle la <strong>brecha de perspectiva</strong> y realizar la proyección:</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">Vector4</span><span class="w"> </span><span class="nf">ProjectMatrix</span><span class="p">(</span><span class="n">Matrix4</span><span class="w"> </span><span class="n">perspectiveMatrix</span><span class="p">,</span><span class="w"> </span><span class="n">Vector4</span><span class="w"> </span><span class="n">originalVector</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Multiplicar la matriz de proyección por el vector original</span>
<span class="w">    </span><span class="n">Vector4</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">originalVector</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">perspectiveMatrix</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Realizar la brecha de perspectiva con el valor original de z guardado en w</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">w</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">result</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
<span class="w">        </span><span class="n">result</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
<span class="w">        </span><span class="n">result</span><span class="p">.</span><span class="n">z</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Para hacer uso de esta nueva funcionalidad tendremos que sustituir el código de proyección anterior, empezando por definir la configuración de la matriz de perspectiva. Podemos definirla inicialmente en <code>window.h</code>:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* Projection settings */</span>
<span class="kt">float</span><span class="w"> </span><span class="n">fovFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// 60º in radians</span>
<span class="kt">float</span><span class="w"> </span><span class="n">aspectRatio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">windowHeight</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">windowWidth</span><span class="p">);</span>
<span class="kt">float</span><span class="w"> </span><span class="n">zNear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">zFar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20.0</span><span class="p">;</span>
<span class="n">Matrix4</span><span class="w"> </span><span class="n">projectionMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">PerspectiveMatrix</span><span class="p">(</span><span class="n">fovFactor</span><span class="p">,</span><span class="w"> </span><span class="n">aspectRatio</span><span class="p">,</span><span class="w"> </span><span class="n">zNear</span><span class="p">,</span><span class="w"> </span><span class="n">zFar</span><span class="p">);</span>
</code></pre></div>
<p>Ahora realizaremos la proyección utilizando matrices, para ello utilizaremos un nuevo método <code>triangle.ProjectWorldVertex</code>:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/*** Apply projections for all face vertices ***/</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Project the current vertex using matrices</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ProjectWorldVertex</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="o">-&gt;</span><span class="n">projectionMatrix</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Translate the projected vertex to the middle screen</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">projectedVertices</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">windowWidth</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">projectedVertices</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">y</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">windowHeight</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Este método cambiará algunas cosas internas respecto al antiguo, empezando por el hecho de que ahora los vértices proyectados serán un <code>Vector4</code> en lugar de un <code>Vector2</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">Vector4</span><span class="w"> </span><span class="n">projectedVertices</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w"> </span><span class="c1">// 2d vertices</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">ProjectWorldVertex</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vertexIndex</span><span class="p">,</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">projectionMatrix</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Use a matrix to world project the original vertex</span>
<span class="w">    </span><span class="n">Vector4</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">{</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]};</span>
<span class="w">    </span><span class="n">projectedVertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">ProjectMatrix</span><span class="p">(</span><span class="n">projectionMatrix</span><span class="p">,</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<p>Si ejecutamos el programa veremos solo un punto en el centro:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/image-71.png" /></p>
<p>El problema está relacionado con el normalizado del espacio proyectado <strong>NDC</strong> (<em>Normalized Device Coordinates</em>). </p>
<p>Como todo está en el rango <code>(-1, 1)</code> debemos escalar los vértices proyectados por la mitad del ancho y alto de la pantalla, importante hacerlo antes de la traslación (recordar el orden):</p>
<div class="highlight"><pre><span></span><code><span class="cm">/*** Apply projections for all face vertices ***/</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Project the current vertex using matrices</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ProjectWorldVertex</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">window</span><span class="o">-&gt;</span><span class="n">projectionMatrix</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// First scale the projected vertex by screen sizes</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">projectedVertices</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">x</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="p">(</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">windowWidth</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">);</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">projectedVertices</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">y</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="p">(</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">windowHeight</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Then translate the projected vertex to the middle screen</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">projectedVertices</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">windowWidth</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">);</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">projectedVertices</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">y</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">window</span><span class="o">-&gt;</span><span class="n">windowHeight</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>El resultado será el mismo de antes, pero al haber incorporado la relación de aspecto, el punto de vista y la normalización nos dará mucho juego:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/anim-21.gif" /></p>
<p>Por lo pronto deberíamos hacer que si se modifica el <code>POV</code> cambie, además de poder establecerlo en grados:</p>
<div class="highlight"><pre><span></span><code><span class="kt">float</span><span class="w"> </span><span class="n">fovFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">;</span><span class="w">                         </span><span class="c1">// 60º in radians</span>
<span class="kt">float</span><span class="w"> </span><span class="n">fovFactorInGrades</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">180.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">M_PI</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fovFactor</span><span class="p">;</span><span class="w"> </span><span class="c1">// 60º en grados</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Campo de visión&quot;</span><span class="p">);</span>
<span class="n">ImGui</span><span class="o">::</span><span class="n">SliderFloat</span><span class="p">(</span><span class="s">&quot;Fov&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">fovFactorInGrades</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">);</span>

<span class="c1">// Update Projection Matrix</span>
<span class="n">projectionMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">PerspectiveMatrix</span><span class="p">(</span>
<span class="w">    </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">fovFactorInGrades</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">180.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="p">,</span><span class="w"> </span><span class="n">aspectRatio</span><span class="p">,</span><span class="w"> </span><span class="n">zNear</span><span class="p">,</span><span class="w"> </span><span class="n">zFar</span><span class="p">);</span>
</code></pre></div>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/anim-22.gif" /></p>
<h2 id="proyeccion-de-valores-negativos">Proyección de valores negativos<a class="headerlink" href="#proyeccion-de-valores-negativos" title="Permanent link">&para;</a></h2>
<p>Ahora que estamos pensando en clave de <strong>NDC</strong> (<em>Normalized Device Coordinates</em>), podemos cuestionarnos a fondo qué ocurrirá cuando un vector se encuentre proyectado por detrás de la cámara, es decir, que no podamos verlo. ¿Qué tipo de resultado obtendremos?</p>
<p>Al aplicar la brecha de perspectiva:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex067.png" /></p>
<p>Al tener en <code>W</code> un componente <code>Z</code> no transformado y potencialmente negativo, el resultado que obtendremos al proyectarlo será una proyeción volteada del objeto como consecuencia de dividir los componentes <code>x</code>, <code>y</code>, <code>z</code> entre un número negativo.</p>
<p>El caso es que antes de que esto ocurra, cuando el objeto se encuentre por detrás de la cámara, el programa se bloqueará y finalizará abruptamente:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/anim-23.gif" /></p>
<p>Esto ocurre porque no hemos implementado ningún tipo de protección al intentar dividir los valores entre cero, como sería el <em>clipping</em>, basado en descartar los objetos fuera del <code>frustum</code> para no renderizarlos:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/image-72.png" /></p>
<p>Este proceso tiene lugar normalmente entre la proyección de la matriz y la brecha de perspectiva, por eso es buena idea dividir esas dos operaciones.</p>
<p>En cualquier caso implementaré el <em>clipping</em> más adelante, una vez tenga el terreno preparado.</p>
<h2 id="orden-mayor-de-fila-columna">Orden mayor de fila-columna<a class="headerlink" href="#orden-mayor-de-fila-columna" title="Permanent link">&para;</a></h2>
<p>Antes de continuar, un breve apunte sobre la representación de vectores. Tenemos dos formas de representarlos.</p>
<p>Por <strong>orden mayor de columna</strong>:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex068.png" /></p>
<p>O por <strong>orden mayor de fila</strong>:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex069.png" /></p>
<p>Es importante porque este cambio en la representación no es solo estético, pues hablando de dimensiones no es lo mismo <code>4x1</code> que <code>4x1</code>, algo que afecta directamente a operaciones como la multiplicación de matrices:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex070.png" /></p>
<p>Pues no cumplen la propiedad conmutativa:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex071.png" /></p>
<p>Hay que tenerlo en cuenta pues no es lo mismo trabajar con <strong>OpenGL</strong> que utiliza orden mayor de columna, que con <strong>DirectX</strong> o programas como <strong>Maya</strong> que utilizan orden mayor de fila.</p>
<p>Con <strong>orden mayor de columna</strong> el vector se opera después de la matriz:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex072.png" /></p>
<p>Con <strong>orden mayor de fila</strong> el vector se opera antes de la matriz:</p>
<p><img alt="" src="https://hektorprofe.github.io/docs/cdn//graficos3d/latex073.png" /></p>
<p>Esto afecta directamente a la configuración de las matrices de transformación y el orden:</p>
<ul>
<li><strong>Orden mayor de fila</strong>: <code>P' = P * Ry * Rz * T</code></li>
<li><strong>Orden mayor de columna</strong>: <code>P' = T * Rz * Ry * P</code></li>
</ul>
<p>Distintas formas de interpretar el mundo, distintas formas de trabajar en él, no lo olvidemos.</p>
<hr />
<p><small class="edited"><i>Última edición: 05 de Junio de 2022</i></small></p>
                  
                    
                  
                
                
                  


                
              </article>
            </div>
          </div>
        </main>
        
          
<footer class="md-footer">
  
  <div class="md-footer-nav">
    <nav class="md-footer-nav__inner md-grid">
      
      <a
        href="../16-matrices-de-transformacion-3d/"
        title="Matrices de transformación 3D"
        class="md-flex md-footer-nav__link md-footer-nav__link--prev"
        rel="prev"
      >
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
        </div>
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Anterior
            </span>
            Matrices de transformación 3D
          </span>
        </div>
      </a>
       
      <a
        href="../18-luz-y-sombreado/"
        title="Luz y sombreado"
        class="md-flex md-footer-nav__link md-footer-nav__link--next"
        rel="next"
      >
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Siguiente
            </span>
            Luz y sombreado
          </span>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
        </div>
      </a>
      
    </nav>
  </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <!--<div class="md-footer-links__highlight">
          <a href="/comunidad/">Comunidad</a> · <a href="/politica-de-cookies/">Política de cookies</a> · <a href="/sobre-mi/">Sobre mí</a>
        </div>-->
        <div class="md-footer-copyright__highlight">
          2015 - 2022 &copy; Héctor Costa Guzmán (<u
            ><a
              href="https://creativecommons.org/licenses/by/4.0/deed.es"
              target="_blank"
              rel="nofollow"
              >Licencia CC BY 4.0</a
            ></u
          >)
        </div>
      </div>
       
<style>.md-footer-social__link {transition: 0.3s;}</style>
<div class="md-footer-social" style="font-size: 2.5rem; margin-top: -6px!important; padding: 0px!important; margin-bottom: -6px; overflow: hidden!important;">
  <a href="https://github.com/hcosta" title="Github" target="_blank" class="md-footer-social__link fa fa-github-square"></a>
  <a href="https://www.youtube.com/c/HektorProfe" title="Youtube" target="_blank" class="md-footer-social__link fa fa-youtube-square"></a>
  &nbsp;
</div>
 
    </div>
  </div>
  <script>
    (function (i, s, o, g, r, a, m) {
      i["GoogleAnalyticsObject"] = r;
      (i[r] =
        i[r] ||
        function () {
          (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
      (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m);
    })(
      window,
      document,
      "script",
      "https://www.google-analytics.com/analytics.js",
      "ga"
    );
    ga("create", "UA-124845547-1", "auto");
    ga("send", "pageview");
  </script>
</footer>
        
        <a id="anchorID" href="https://www.hektorprofe.net/" target="_blank"></a>
      </div>
      <script type='text/javascript'
              src="https://hektorprofe.github.io/docs/assets/javascripts/application.a26c1c21.js"></script>
      <script src="https://hektorprofe.github.io/docs/assets/javascripts/tingle.min.js"></script>
      <script type='text/javascript'>
    var modalButtonOnly = new tingle.modal({
        closeMethods: [],
        footer: true,
        stickyFooter: true
    });
    var btn5 = document.querySelector('.js-tingle-modal-5');

    // set content
    modalButtonOnly.setContent(`
    <div style="display:grid;grid-template-columns:32% 32% 32%;grid-column-gap: 1.33%;" id="supermodal">
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/python" target="_blank"><img src="assets/python.png" style="width:100%;justify-self:center;align-self:center;" /></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/django" target="_blank"><img src="assets/django.png" style="width:100%;justify-self:center;align-self:center;" /></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/pyside" target="_blank"><img src="assets/pyside.png" style="width:100%;justify-self:center;align-self:center;" /></a>
      </div>
    </div>`);

    modalButtonOnly.addFooterBtn('Cerrar', 'tingle-btn tingle-btn--default tingle-btn--pull-right', function(){
      modalButtonOnly.close();
    });

    app.initialize({version:"1.2.3",url:{base:"../.."}})
    var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoad=e()}(this,function(){"use strict";function t(t,e,n){var o=e._settings;!n&&i(t)||(C(o.callback_enter,t),R.indexOf(t.tagName)>-1&&(N(t,e),I(t,o.class_loading)),E(t,e),a(t),C(o.callback_set,t))}var e={elements_selector:"img",container:document,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,callback_load:null,callback_error:null,callback_set:null,callback_enter:null,callback_finish:null,to_webp:!1},n=function(t){return _extends({},e,t)},o=function(t,e){return t.getAttribute("data-"+e)},r=function(t,e,n){var o="data-"+e;null!==n?t.setAttribute(o,n):t.removeAttribute(o)},a=function(t){return r(t,"was-processed","true")},i=function(t){return"true"===o(t,"was-processed")},s=function(t,e){return r(t,"ll-timeout",e)},c=function(t){return o(t,"ll-timeout")},l=function(t){return t.filter(function(t){return!i(t)})},u=function(t,e){return t.filter(function(t){return t!==e})},d=function(t,e){var n,o=new t(e);try{n=new CustomEvent("LazyLoad::Initialized",{detail:{instance:o}})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:o})}window.dispatchEvent(n)},f=function(t,e){return e?t.replace(/\.(jpe?g|png)/gi,".webp"):t},_="undefined"!=typeof window,v=_&&!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),g=_&&"IntersectionObserver"in window,h=_&&"classList"in document.createElement("p"),b=_&&function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),m=function(t,e,n,r){for(var a,i=0;a=t.children[i];i+=1)if("SOURCE"===a.tagName){var s=o(a,n);p(a,e,s,r)}},p=function(t,e,n,o){n&&t.setAttribute(e,f(n,o))},y=function(t,e){var n=b&&e.to_webp,r=o(t,e.data_src),a=o(t,e.data_bg);if(r){var i=f(r,n);t.style.backgroundImage='url("'+i+'")'}if(a){var s=f(a,n);t.style.backgroundImage=s}},w={IMG:function(t,e){var n=b&&e.to_webp,r=e.data_srcset,a=t.parentNode;a&&"PICTURE"===a.tagName&&m(a,"srcset",r,n);var i=o(t,e.data_sizes);p(t,"sizes",i);var s=o(t,r);p(t,"srcset",s,n);var c=o(t,e.data_src);p(t,"src",c,n)},IFRAME:function(t,e){var n=o(t,e.data_src);p(t,"src",n)},VIDEO:function(t,e){var n=e.data_src,r=o(t,n);m(t,"src",n),p(t,"src",r),t.load()}},E=function(t,e){var n=e._settings,o=t.tagName,r=w[o];if(r)return r(t,n),e._updateLoadingCount(1),void(e._elements=u(e._elements,t));y(t,n)},I=function(t,e){h?t.classList.add(e):t.className+=(t.className?" ":"")+e},L=function(t,e){h?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},C=function(t,e){t&&t(e)},O=function(t,e,n){t.addEventListener(e,n)},k=function(t,e,n){t.removeEventListener(e,n)},x=function(t,e,n){O(t,"load",e),O(t,"loadeddata",e),O(t,"error",n)},A=function(t,e,n){k(t,"load",e),k(t,"loadeddata",e),k(t,"error",n)},z=function(t,e,n){var o=n._settings,r=e?o.class_loaded:o.class_error,a=e?o.callback_load:o.callback_error,i=t.target;L(i,o.class_loading),I(i,r),C(a,i),n._updateLoadingCount(-1)},N=function(t,e){var n=function n(r){z(r,!0,e),A(t,n,o)},o=function o(r){z(r,!1,e),A(t,n,o)};x(t,n,o)},R=["IMG","IFRAME","VIDEO"],S=function(e,n,o){t(e,o),n.unobserve(e)},M=function(t){var e=c(t);e&&(clearTimeout(e),s(t,null))},j=function(t,e,n){var o=n._settings.load_delay,r=c(t);r||(r=setTimeout(function(){S(t,e,n),M(t)},o),s(t,r))},D=function(t){return t.isIntersecting||t.intersectionRatio>0},T=function(t){return{root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}},U=function(t,e){this._settings=n(t),this._setObserver(),this._loadingCount=0,this.update(e)};return U.prototype={_manageIntersection:function(t){var e=this._observer,n=this._settings.load_delay,o=t.target;n?D(t)?j(o,e,this):M(o):D(t)&&S(o,e,this)},_onIntersection:function(t){t.forEach(this._manageIntersection.bind(this))},_setObserver:function(){g&&(this._observer=new IntersectionObserver(this._onIntersection.bind(this),T(this._settings)))},_updateLoadingCount:function(t){this._loadingCount+=t,0===this._elements.length&&0===this._loadingCount&&C(this._settings.callback_finish)},update:function(t){var e=this,n=this._settings,o=t||n.container.querySelectorAll(n.elements_selector);this._elements=l(Array.prototype.slice.call(o)),!v&&this._observer?this._elements.forEach(function(t){e._observer.observe(t)}):this.loadAll()},destroy:function(){var t=this;this._observer&&(this._elements.forEach(function(e){t._observer.unobserve(e)}),this._observer=null),this._elements=null,this._settings=null},load:function(e,n){t(e,this,n)},loadAll:function(){var t=this;this._elements.forEach(function(e){t.load(e)})}},_&&function(t,e){if(e)if(e.length)for(var n,o=0;n=e[o];o+=1)d(t,n);else d(t,e)}(U,window.lazyLoadOptions),U});
    var myLazyLoad = new LazyLoad({elements_selector: ".lazy"});
    const mdMenuItems = document.querySelectorAll('.md-nav__link');
    function doNav(){ document.getElementById("main__list").innerHTML = '<li class="md-nav__item"><a class="md-nav__link" href="/cursos/">Cursos</a></li><li class="md-nav__item"><a class="md-nav__link" href="/blog/">Blog</a></li>';}
    for (i = 0; i < mdMenuItems.length; i++) {  var item = mdMenuItems[i]; var htmlstring = item.innerHTML; htmlstring = (htmlstring.trim) ? htmlstring.trim() : htmlstring.replace(/^\s+/,''); if (htmlstring == 'Servidor de encuentro') { item.parentNode.removeChild(item);continue; }  if (htmlstring == 'Política de Cookies') { item.parentNode.removeChild(item);continue; } if (htmlstring == 'Buscador') { item.parentNode.removeChild(item); continue; } }
    try { var topPos = document.querySelector('#md__active_link').offsetTop; document.querySelector('#md__sidebar__scroll').scrollTop = topPos - 60; } catch (err) {}
      </script>
    </body>
  </html>