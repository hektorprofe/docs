<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
    
    
    

    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Web de apuntes de programación de Hector Costa Guzman.">
      
      
        <link rel="canonical" href="https://docs.hektorprofe.net/graficos-3d/16-matrices-de-transformacion-3d/">
      
      
        <meta name="author" content="Héctor Costa Guzman">
      
      <link rel="shortcut icon" href="/favicon.ico">
    
    
      
        <title>Matrices de transformación 3D | Programación de gráficos 3D | Hektor Profe</title>
      
    
    <link rel="stylesheet" href="../../assets/stylesheets/application.2.css">
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    
    <link rel="stylesheet" href="/assets/stylesheets/tingle.min.css">
<style>
@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("/assets/fonts/specimen/MaterialIcons-Regular.woff2") format("woff2"),url("/assets/fonts/specimen/MaterialIcons-Regular.woff") format("woff"),url("/assets/fonts/specimen/MaterialIcons-Regular.ttf") format("truetype")}
[data-md-color-primary="grey"] .md-header { background-color: #191A1D }
[data-md-color-primary="grey"] .md-tabs { background-color: #222831 }
.md-footer-nav { background-color: #222831; }
.md-footer-meta { background-color: #191A1D }
html [data-md-color-primary="grey"] .md-nav--primary .md-nav__title--site { background-color: #191A1D; }
.mini{ display: none; } .maxi{ display: block; }
.embed-container { position: relative; padding-bottom: 56.25%;height: 0; overflow: hidden; max-width: 100%; height: auto; margin-bottom: 0; } 
.embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.md-nav__link:focus, .md-nav__link:hover { color: #018dc5; }
.headerlink{ color: #018dc5 !important; }
.md-footer-links__highlight a{ color: #777 !important; }
.md-footer-links__highlight a:hover{ color: #ddd !important; }
.visible{ display: inherit !important; }
/*.md-tabs { display: none !important; }*/
.nav__btn, .nav__logo{ transition: 0.3s; }
.nav__btn:hover{ color: #aaa; }
.nav__logo:hover{ opacity:.7; }
.nav__logo {max-width: 225px !important; }
img:not([src]){visibility:hidden;}
img.click{opacity: 0.96;box-shadow:rgb(79, 82, 92) -4px 4px}
img.click:hover{opacity: 1;box-shadow:rgb(10, 172, 237) -4px 4px}
.button { background-color: #36bf2d; border: none; color: white !important; padding: 20px 0px; text-align: center; text-decoration: none; display: block; font-size: 97%; width: 100%; font-weight: bold;}
.button:hover { background-color: #4CAF50; color: white; }
.animated.delay-1dot5s {animation-delay: 1.5s;}
.md-icon--search { display:inline-block!important}
a.headerlink{ display: none !important; }
small.edited { display: block; text-align: right; }
#cookie-bar { padding: 1.8rem 1.25rem !important; background: #191A1D  !important; box-shadow:rgba(0, 0, 0, 0.2) 4px 4px 8px 8px; }
#cookie-bar-prompt-logo{ display: none !important; }
div.my-img{text-align:center;margin-top:20px}
@media (max-width: 76.1875em){ .mini{ display: block; } .maxi{ display: none;} /*.md-nav__link[for="nav-1"] { display: none; }*/ }
@media (min-width: 1599.9px){ .md-header-nav__button.md-logo img { height: 37.5px !important; width: 220px; } }
@media (min-width: 1999.9px){ .md-header-nav__button.md-logo img { height: 40px !important; width: 240px; } }
/* Rectificación footer en paginas pequeñas de altura */
@media (max-width: 1599.8px){ .md-container {height: calc(100% - 48px)} }
@media (min-width: 1599.9px){ .md-container {height: calc(100% - 53px)} }
@media (min-width: 1999.9px){ .md-container {height: calc(100% - 58px)} }
@media only screen and (max-width: 959.9px) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 960px) and (max-width: 76.1875em) { .nav__logo { display: block !important; }} 
@media only screen and (min-width: 76.1875em) { .nav__logo { display: none !important; } } 
@media only screen and (max-width: 76.1875em) { .md-sidebar--primary { left: -26.2rem;; width: 26.2rem; }  [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(26.2rem); transform: translateX(26.2rem); } [dir="rtl"] [data-md-toggle="drawer"]:checked ~ .md-container .md-sidebar--primary { -webkit-transform: translateX(-26.2rem); transform: translateX(-26.2rem); } }
@media (min-width: 1219.9px){ #home__btn { display: none !important; } #cursos__btn{ color: white !important; } [data-md-color-primary="grey"] .md-nav__link--active{ color: rgba(0, 0, 0, 0.87); text-decoration: underline !important; } }
@media (min-width: 467.9px){ #discord__btn{ display: inline-block !important; } }
@media only screen and (min-width: 60em){ .md-search__input { background-color: rgb(53, 54, 56); } .md-search__input:hover { background-color: rgb(84, 87, 93); color: white; }}
@media (max-width: 1219.9px){ .md-header-nav__title{ padding: 0 1rem; } .nav__btn {display:none;} }
@media (max-width: 875.9px){ #cookie-bar-button{ margin-top: 20px !important; }}
@media (max-width: 719.9px){ #cookie-bar { padding: 3.25rem 1.25rem; }}
@media (max-width: 512.9px){ #cookie-bar { padding: 2rem 1.25rem; }}

.tingle-modal { font-size:18px !important;}
.tingle-modal-box{ width: 80%; max-width: 1100px; }
.tingle-btn--danger{ background: darkorange !important; }
.tingle-modal-box__content { padding: 3rem 2rem 3rem 3rem;}
@media (max-width: 540px){ .tingle-modal-box{ width: auto; } }
@media (max-width: 849px){ #supermodal{ grid-template-columns:100% !important; }}

.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 275px - 60px)}
@media (max-width: 1999.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 246px - 60px);margin-right:-1px;}}
@media (max-width: 1599.9px){.md-sidebar--secondary .md-sidebar__scrollwrap {max-height: calc(100% - 222px - 60px)}}

</style>
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="grey" data-md-color-accent="grey">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#matrices-de-transformacion-3d" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header
  class="md-header"
  data-md-component="header"
  style="position: inherit !important"
>
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a
          href="/"
          title="Hektor Profe"
          class="md-header-nav__button md-logo"
          style="font-size: 0px"
        >
          <img
            src="/assets/images/logo.png"
            width="200px"
            height="35px"
            style="margin-top: -5px"
            alt="Hektor Profe"
            title="Hektor Profe"
          />
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label
          class="md-icon md-icon--menu md-header-nav__button"
          for="__drawer"
        ></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div
          class="md-flex__ellipsis md-header-nav__title"
          data-md-component="title"
          style="text-align: right"
        >
          <!-- https://fontawesome.com/v4.7.0/ -->
          <a 
            class="nav__btn" 
            href="https://www.hektorprofe.net/" 
            style="margin-left:0em;" 
            title="Cursos de Hektor Profe">
            Cursos
          </a>
          <a 
            class="nav__btn" 
            href="https://docs.hektorprofe.net/" 
            style="margin-left:1.4em;" 
            title="Documentos de Hektor Profe">
            Documentos
          </a>
          <a 
            class="nav__btn" 
            href="https://www.hektorprofe.net/portafolio/" 
            style="margin-left:1.4em;" 
            title="Portafolio de Hektor Profe">
            Portafolio
          </a>
          <a href="/"
            ><img
              class="nav__logo"
              src="/assets/images/logo.png"
              width="200px"
              height="35px"
              style="margin: 6px auto 0"
              alt="Hektor Profe"
              title="Hektor Profe"
          /></a>
        </div>
        <style>
          .md-sidebar[data-md-state="lock"] {
            top: 0rem !important;
          }
          .md-tabs {
            display: none !important;
          }
          .hde {
            display: inline-block;
          }
          .admonition.note > .superfences-tabs > label:hover,
          .headerlink {
            color: #018dc5 !important;
          }
          .admonition.info {
            font-size: 100%;
          }
          .admonition.info label {
            font-size: 91%;
          }
          .admonition.note > .admonition-title {
            display: none;
          }
          .image {
            text-align: center;
            margin-top: 25px;
          }
          .contenedor_youtube {
            position: relative !important;
            padding-bottom: 56.25% !important; /*panorámico*/
            padding-top: 0px !important;
            height: 0 !important;
            margin-top: -20px;
            margin-bottom: 25px;
          }
          .contenedor_youtube iframe {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
          }
        </style>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container" style="padding-top: 0px !important;">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list" id="top__tabs">
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
          <li class="md-tabs__item"><a href="javascript://" class="md-tabs__link">&nbsp;</a></li>
        
      </ul>
    </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container" style="padding-top: 8px !important;">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap" id="md__sidebar__scroll">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title" for="__drawer" style="padding:0 !important;max-height:5.5rem;"></label>
  
  <ul class="md-nav__list" id="main__list" data-md-scrollfix>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
        <!-- comprobación extra -->
         
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      Apuntes de Gráficos 3D
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Apuntes de Gráficos 3D
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
            
            
            


  <li class="md-nav__item">
    <a href="../" title="Índice del archivo" class="md-nav__link">
      Índice del archivo
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../01-configuracion-previa/" title="Configuración previa" class="md-nav__link">
      Configuración previa
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../02-buffer-de-color/" title="Buffer de color" class="md-nav__link">
      Buffer de color
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../03-vectores-y-puntos/" title="Vectores y puntos" class="md-nav__link">
      Vectores y puntos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../04-proyeccion-de-puntos/" title="Proyección de puntos" class="md-nav__link">
      Proyección de puntos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../05-transformaciones-lineales/" title="Transformaciones lineales" class="md-nav__link">
      Transformaciones lineales
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../06-triangulos-vertices-mallas/" title="Triángulos, vértices y mallas" class="md-nav__link">
      Triángulos, vértices y mallas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../07-rasterizacion-de-lineas/" title="Rasterización de líneas" class="md-nav__link">
      Rasterización de líneas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../08-mallas-en-memoria-dinamica/" title="Mallas en memoria dinámica" class="md-nav__link">
      Mallas en memoria dinámica
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../09-ficheros-con-modelos-obj/" title="Ficheros con modelos OBJ" class="md-nav__link">
      Ficheros con modelos OBJ
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../10-operaciones-con-vectores/" title="Operaciones con vectores" class="md-nav__link">
      Operaciones con vectores
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../11-back-face-culling/" title="Back-face Culling" class="md-nav__link">
      Back-face Culling
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../12-rasterizacion-de-triangulos/" title="Rasterización de triángulos" class="md-nav__link">
      Rasterización de triángulos
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../13-interfaz-dear-imgui/" title="Interfaz Dear ImGui" class="md-nav__link">
      Interfaz Dear ImGui
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../14-ordenar-caras-por-profundidad/" title="Ordenar caras por profundidad" class="md-nav__link">
      Ordenar caras por profundidad
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../15-operaciones-con-matrices/" title="Operaciones con matrices" class="md-nav__link">
      Operaciones con matrices
    </a>
  </li>

        
            
            
            

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Matrices de transformación 3D
      </label>
    
    <a href="./" title="Matrices de transformación 3D" class="md-nav__link md-nav__link--active" id="md__active_link">
      Matrices de transformación 3D
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#matriz-de-escalado-3d" title="Matriz de escalado 3D" class="md-nav__link toc__link">
    Matriz de escalado 3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matriz-de-traslacion-3d" title="Matriz de traslación 3D" class="md-nav__link toc__link">
    Matriz de traslación 3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matriz-de-rotacion-3d" title="Matriz de rotación 3D" class="md-nav__link toc__link">
    Matriz de rotación 3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matriz-de-mundo-3d" title="Matriz de mundo 3D" class="md-nav__link toc__link">
    Matriz de mundo 3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflexion-sobre-la-traslacion" title="Reflexión sobre la traslación" class="md-nav__link toc__link">
    Reflexión sobre la traslación
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../17-matriz-de-proyeccion/" title="Matriz de proyección" class="md-nav__link">
      Matriz de proyección
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../18-luz-y-sombreado/" title="Luz y sombreado" class="md-nav__link">
      Luz y sombreado
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../19-migracion-a-visual-studio/" title="Migración a Visual Studio" class="md-nav__link">
      Migración a Visual Studio
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../20-mapeado-de-texturas/" title="Mapeado de texturas" class="md-nav__link">
      Mapeado de texturas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../21-interpolacion-de-perspectiva/" title="Interpolación de perspectiva" class="md-nav__link">
      Interpolación de perspectiva
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../22-decodificacion-de-ficheros-png/" title="Decodificación de ficheros PNG" class="md-nav__link">
      Decodificación de ficheros PNG
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../23-ficheros-obj-con-texturas/" title="Ficheros OBJ con texturas" class="md-nav__link">
      Ficheros OBJ con texturas
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../24-profundidad-con-z-buffer/" title="Profundidad con Z-Buffer" class="md-nav__link">
      Profundidad con Z-Buffer
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../25-matriz-de-vista-y-camara/" title="Matriz de vista y cámaras" class="md-nav__link">
      Matriz de vista y cámaras
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../26-renderizado-y-debug-separado/" title="Renderizado y debug separado" class="md-nav__link">
      Renderizado y debug separado
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../27-clipping/" title="Clipping" class="md-nav__link">
      Clipping
    </a>
  </li>

        
            
            
            


  <li class="md-nav__item">
    <a href="../28-multiples-mallas/" title="Múltiples mallas" class="md-nav__link">
      Múltiples mallas
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      
    
      
    
      
    
      
    
      
    
      
    
  </ul>
</nav>

                  </div>
                </div>
              </div>
            

            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                
                  
                    <div class="course-offer" style="margin-bottom:25px;padding:0px 10px;">
                      <a href="https://www.hektorprofe.net/cupon/python" target="_blank">
                        <img src="/cdn/assets/python.png" style="width:100%;justify-self:center;align-self:center;"/>
                      </a>
                    </div>
                  
                

                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#matriz-de-escalado-3d" title="Matriz de escalado 3D" class="md-nav__link toc__link">
    Matriz de escalado 3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matriz-de-traslacion-3d" title="Matriz de traslación 3D" class="md-nav__link toc__link">
    Matriz de traslación 3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matriz-de-rotacion-3d" title="Matriz de rotación 3D" class="md-nav__link toc__link">
    Matriz de rotación 3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matriz-de-mundo-3d" title="Matriz de mundo 3D" class="md-nav__link toc__link">
    Matriz de mundo 3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reflexion-sobre-la-traslacion" title="Reflexión sobre la traslación" class="md-nav__link toc__link">
    Reflexión sobre la traslación
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="matrices-de-transformacion-3d">Matrices de transformación 3D<a class="headerlink" href="#matrices-de-transformacion-3d" title="Permanent link">&para;</a></h1>
<p>En este bloque vamos a repasar las diferentes matrices de transformación para aplicar en entornos 3D. Estas matrices se pueden presentar individualmente o de forma combinada (<strong>traslación</strong>, <strong>rotación</strong>, <strong>escalado</strong> o <strong>transformación de mundo</strong>).</p>
<p>En álgebra lineal, las transformaciones lineales pueden representarse con matrices. Generalmente se utilizan matrices <code>4x4</code> para representar transformaciones 3D:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}m&space;&&space;m&space;&&space;m&space;&&space;m&space;\\m&space;&&space;&space;m&&space;m&space;&&space;m&space;\\m&space;&&space;m&space;&&space;m&space;&&space;m&space;\\m&space;&&space;m&space;&&space;m&space;&&space;m&space;\\\end{bmatrix}{\color{Red}*&space;}\begin{bmatrix}x&space;\\y&space;\\z&space;\\&space;\\\end{bmatrix}&space;"/></p>
<p>Utilizamos matrices <code>4x4</code> en lugar de <code>3x3</code> porque algunas transformaciones especiales, como la traslación, requiere una columna/fila extra para realizarse correctamente. </p>
<p>Para permtir la multiplicación matriz-vector añadiremos un componente <code>w</code> al vector al que por ahora daremos el valor <code>1</code>:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}m&space;&&space;m&space;&&space;m&space;&&space;m&space;\\m&space;&&space;&space;m&&space;m&space;&&space;m&space;\\m&space;&&space;m&space;&&space;m&space;&&space;m&space;\\m&space;&&space;m&space;&&space;m&space;&&space;m&space;\\\end{bmatrix}{\color{Red}*&space;}\begin{bmatrix}x&space;\\y&space;\\z&space;\\1&space;\\\end{bmatrix}&space;"/></p>
<h2 id="matriz-de-escalado-3d">Matriz de escalado 3D<a class="headerlink" href="#matriz-de-escalado-3d" title="Permanent link">&para;</a></h2>
<p>La matriz que aplicaremos para realizar un escalado 3D es la siguiente:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}{\color{Blue}&space;sx}&space;&&space;0&space;&&space;0&space;&&space;0&space;\\0&space;&&space;&space;{\color{Blue}&space;sy}&&space;0&space;&&space;0&space;\\0&space;&&space;0&space;&&space;{\color{Blue}&space;sz}&space;&&space;0&space;\\0&space;&&space;0&space;&&space;0&space;&&space;1&space;\\\end{bmatrix}{\color{Red}*&space;}\begin{bmatrix}x&space;\\y&space;\\z&space;\\1&space;\\\end{bmatrix}&space;"/></p>
<p>Aquí <code>sx</code>, <code>sy</code> y <code>sz</code> representan el factor de escalado para cada componente.</p>
<p>El resultado de aplicarla será el siguiente:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}({\color{Blue}&space;sx}&space;*&space;x)&plus;&space;0&space;&plus;&space;0&space;&plus;&space;0&space;\\0&space;&plus;&space;&space;({\color{Blue}&space;sy}&space;*&space;y)&plus;&space;0&space;&plus;&space;0&space;\\0&space;&plus;&space;0&space;&plus;&space;({\color{Blue}&space;sz}&space;*&space;z)&space;&plus;&space;0&space;\\0&space;&plus;&space;0&space;&plus;&space;0&space;&plus;&space;(1&space;*1)&space;\\\end{bmatrix}=\begin{bmatrix}{\color{Blue}&space;sx}&space;*&space;x&space;\\{\color{Blue}&space;sy}&space;*&space;y&space;\\{\color{Blue}&space;sz}&space;*&space;z&space;\\1&space;\\\end{bmatrix}&space;"/></p>
<p>Para poder aplicar esta funcionalidad necesitamos modificar el código, ya que en él no estamos utilizando matrices sino que estamos aplicando las fórmulas trigonométricas manualmente. </p>
<p>Así que lo primero será definir nuestro nuevo tipo <code>Matrix4</code>:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#ifndef MATRIX_H</span>
<span class="cp">#define MATRIX_H</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;vector.h&quot;</span><span class="cp"></span>

<span class="k">class</span><span class="w"> </span><span class="nc">Matrix4</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="nf">IdentityMatrix</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//  |  1  0  0  0 |</span>
<span class="w">        </span><span class="c1">//  |  0  1  0  0 |</span>
<span class="w">        </span><span class="c1">//  |  0  0  1  0 |</span>
<span class="w">        </span><span class="c1">//  |  0  0  0  1 |</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Matrix4</span><span class="p">{{{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">}}};;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="nf">ScalationMatrix</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//  | sx  0  0  0 |</span>
<span class="w">        </span><span class="c1">//  |  0 sy  0  0 |</span>
<span class="w">        </span><span class="c1">//  |  0  0 sz  0 |</span>
<span class="w">        </span><span class="c1">//  |  0  0  0  1 |</span>
<span class="w">        </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">IdentityMatrix</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cp">#endif</span>
</code></pre></div>
<p>Ahora debemos de hacer uso de esta nueva clase matriz y sus métodos en el <code>mesh</code>. </p>
<p>Primero añadiremos vectores para manejar la rotación, escalado y traslación, preparando ya el terreno también para las próximas transformaciones:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Mesh</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">Vector3</span><span class="w"> </span><span class="n">scale</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">Vector3</span><span class="w"> </span><span class="n">rotation</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">Vector3</span><span class="w"> </span><span class="n">translation</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Llamaremos al método de escalado para cada vértice del triángulo en el método <code>mesh.Update()</code>: </p>
<div class="highlight"><pre><span></span><code><span class="cm">/*** Apply transformations for all face vertices ***/</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ORDER MATTERS, REALLY IMPORTANT</span>
<span class="w">    </span><span class="c1">// 1. Scale using the matrix</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ScaleVertex</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// 2. Rotate using the matrices</span>
<span class="w">    </span><span class="c1">// triangles[i].RotateVertex(j, rotation);</span>
<span class="w">    </span><span class="c1">// 3. Translation using the matrix</span>
<span class="w">    </span><span class="c1">// triangles[i].TranslateVertex(j, translation);</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>En este método multiplicaremos el vector de escalado por la matriz de escalado, pero necesitamos tenerlo en formato <code>Vector4</code> para que sean compatibles. Una vez realizado el cálculo estableceremos el vertice con el nuevo valor transformado:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">ScaleVertex</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vertexIndex</span><span class="p">,</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">scale</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Use a matrix to transform scale the origin vertex</span>
<span class="w">    </span><span class="n">Vector4</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">{</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]};</span><span class="w"></span>
<span class="w">    </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">ScalationMatrix</span><span class="p">(</span><span class="n">scale</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">.</span><span class="n">z</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">.</span><span class="n">ToVector3</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>El nuevo tipo de dato <code>Vector4</code> es esencialmente un <code>Vector3</code> con la capacidad de ser multiplicado por una <code>Matrix4</code>. Tiene un constructor base y uno a partir de un <code>Vector3</code>, así como métodos para transformarlo a un <code>Vector3</code> y las sobrecargas de la multiplicación pasándole una <code>Matrix4</code>:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#ifndef VECTOR_H</span>
<span class="cp">#define VECTOR_H</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">class</span><span class="w"> </span><span class="nc">Matrix4</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Pre declaration */</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">Vector4</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">z</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">w</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="n">Vector4</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Vector4</span><span class="p">(</span><span class="n">Vector3</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="mi">1</span><span class="p">){};</span><span class="w"></span>
<span class="w">    </span><span class="n">Vector3</span><span class="w"> </span><span class="nf">ToVector3</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">Vector4</span><span class="w"> </span><span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="cp">#endif</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// Definición</span>
<span class="n">Vector3</span><span class="w"> </span><span class="nf">Vector4::ToVector3</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Vector3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">Vector4</span><span class="w"> </span><span class="n">Vector4</span><span class="o">::</span><span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Vector4</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="p">.</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="p">.</span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">w</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Con esto tendremos el sistema preparado, podemos configurar la interfaz para intentar modificar el vector de escalado en tiempo real mediante un nuevo método de la malla para establecer el escalado:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Mesh::SetScale</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">scale</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">scale</span><span class="p">[</span><span class="mi">2</span><span class="p">]};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>En la interfaz añadiremos el widget para el nuevo campo <code>modelScale</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Window</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="cm">/*Model settings */</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">modelScale</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>El código para <strong>ImGui</strong> y debajo para establecer los cambios:</p>
<div class="highlight"><pre><span></span><code><span class="n">ImGui</span><span class="o">::</span><span class="n">Separator</span><span class="p">();</span><span class="w"></span>
<span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Escalado del modelo&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">ImGui</span><span class="o">::</span><span class="n">SliderFloat3</span><span class="p">(</span><span class="s">&quot;Scale&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">modelScale</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Update Model Settings</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">SetScale</span><span class="p">(</span><span class="n">modelScale</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>De paso modificaremos un poco la rotación ya que realmente no queremos una rotación automatizada, sino que podamos establecer la rotación actual a mano:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Window</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="cm">/*Model settings */</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">modelRotation</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>El widget:</p>
<div class="highlight"><pre><span></span><code><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Vector de rotación&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">ImGui</span><span class="o">::</span><span class="n">SliderFloat3</span><span class="p">(</span><span class="s">&quot;Rotation&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">modelRotation</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Update Model Settings</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">SetRotation</span><span class="p">(</span><span class="n">modelRotation</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>Éste llamará a nuestro nuevo método:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Mesh::SetRotation</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">rotation</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">rotation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">rotation</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">rotation</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">rotation</span><span class="p">[</span><span class="mi">2</span><span class="p">]};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Por ahora este es el resultado del escalado con matrices:</p>
<p><img alt="" src="/cdn/graficos3d/anim-17.gif" /></p>
<h2 id="matriz-de-traslacion-3d">Matriz de traslación 3D<a class="headerlink" href="#matriz-de-traslacion-3d" title="Permanent link">&para;</a></h2>
<p>La matriz que aplicaremos para realizar una traslación, modificar la posición en el espacio de la malla, es la siguiente:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}1&0&0&{\color{Blue}tx}\\0&1&0&{\color{Blue}ty}\\0&0&1&{\color{Blue}tz}\\0&0&0&1\\\end{bmatrix}{\color{Red}*}\begin{bmatrix}x\\y\\z\\1\\\end{bmatrix}" /></p>
<p>En esta matriz, la última columna extra, almacena la cantidad de traslación en cada componente <code>tx</code>, <code>ty</code> y <code>tz</code>.</p>
<p>El resultado de aplicarla será el siguiente:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}x&plus;0&plus;0&plus;{\color{Blue}&space;tx}\\0&plus;y&plus;0&plus;{\color{Blue}&space;ty}\\0&plus;0&plus;z&plus;{\color{Blue}&space;tz}\\0&plus;0&plus;0&plus;1\\\end{bmatrix}=\begin{bmatrix}{x&plus;\color{Blue}tx}\\y&plus;{\color{Blue}ty}\\z&plus;{\color{Blue}tz}\\1\\\end{bmatrix}"/></p>
<p>La cuarta columna es la única forma en que podemos representar la traslación en una matriz <code>4x4</code>.</p>
<p>La implementación es muy simple:</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="nf">TranslationMatrix</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//  |  1  0  0  tx  |</span>
<span class="w">    </span><span class="c1">//  |  0  1  0  ty  |</span>
<span class="w">    </span><span class="c1">//  |  0  0  1  tz  |</span>
<span class="w">    </span><span class="c1">//  |  0  0  0   1  |</span>
<span class="w">    </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">IdentityMatrix</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>El nuevo método para trasladar un vértice en <code>Triangle</code> es:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">TranslateVertex</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vertexIndex</span><span class="p">,</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">translation</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Use a matrix to transform translate the origin vertex</span>
<span class="w">    </span><span class="n">Vector4</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">{</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]};</span><span class="w"></span>
<span class="w">    </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">TranslationMatrix</span><span class="p">(</span><span class="n">translation</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">translation</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">translation</span><span class="p">.</span><span class="n">z</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">.</span><span class="n">ToVector3</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Lo aplicaremos durante las transformaciones en <code>mesh.Update()</code> al final de todo, después del escalado y la rotación:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/*** Apply transformations for all face vertices ***/</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ORDER MATTERS, REALLY IMPORTANT</span>
<span class="w">    </span><span class="c1">// 1. Scale using the matrix</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ScaleVertex</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// 2. Rotate using the matrices</span>
<span class="w">    </span><span class="c1">// triangles[i].RotateVertex(j, rotation);</span>
<span class="w">    </span><span class="c1">// 3. Translation using the matrix</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">TranslateVertex</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">translation</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Para modificar la traslación desde la interfaz añadirmeos al <code>mesh</code> el método con la rectificación de la posición de la cámara <code>window.cameraPosition</code> préviamente establecida en <code>{0,0,-5}</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Mesh::SetTranslation</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">translation</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Con rectificación de origen</span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">translation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">translation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">window</span><span class="o">-&gt;</span><span class="n">cameraPosition</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">translation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">window</span><span class="o">-&gt;</span><span class="n">cameraPosition</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">translation</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">window</span><span class="o">-&gt;</span><span class="n">cameraPosition</span><span class="p">[</span><span class="mi">2</span><span class="p">]};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Tanto la traslación como la posición de la cámara la podremos modificaf en la interfaz:</p>
<div class="highlight"><pre><span></span><code><span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Traslación del modelo&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">ImGui</span><span class="o">::</span><span class="n">SliderFloat3</span><span class="p">(</span><span class="s">&quot;Translation&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">modelTranslation</span><span class="p">,</span><span class="w"> </span><span class="mi">-5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
<span class="n">ImGui</span><span class="o">::</span><span class="n">Separator</span><span class="p">();</span><span class="w"></span>
<span class="n">ImGui</span><span class="o">::</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Posición cámara (X,Y,Z)&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">ImGui</span><span class="o">::</span><span class="n">SliderFloat3</span><span class="p">(</span><span class="s">&quot;Camera&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cameraPosition</span><span class="p">,</span><span class="w"> </span><span class="mi">-5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Update Model Settings</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">SetTranslation</span><span class="p">(</span><span class="n">modelTranslation</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>Esta variable <code>window.modelTranslation</code> la adaptaremos de <code>modelPosition</code>, pues el nombre es ahora más acertado:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* Model settings */</span><span class="w"></span>
<span class="kt">float</span><span class="w"> </span><span class="n">modelScale</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="kt">float</span><span class="w"> </span><span class="n">modelRotation</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="kt">float</span><span class="w"> </span><span class="n">modelTranslation</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>

<span class="cm">/* Camera settings */</span><span class="w"></span>
<span class="kt">float</span><span class="w"> </span><span class="n">cameraPosition</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-5</span><span class="p">};</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">fovFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">400</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Con esto deberíamos ser capaces de cambiar la posición del modelo y de la cámara correctamente:</p>
<p><img alt="" src="/cdn/graficos3d/anim-18.gif" /></p>
<h2 id="matriz-de-rotacion-3d">Matriz de rotación 3D<a class="headerlink" href="#matriz-de-rotacion-3d" title="Permanent link">&para;</a></h2>
<p>La rotación 3D se realiza mediante el bloqueo de un eje, por lo que tendremos 3 variantes de la matriz de rotación dependiendo del eje alrededor del cuál queramos rotar. Por lo demás es aplicar la lógica que vimos para realizar una rotación de un vector en 2D.</p>
<p>La matriz de rotación alrededor del eje <code>Z</code>, manteniéndo ese eje intocable (tercera fila y tercera columna) es:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}{\color{Blue}&space;cos(\alpha)}&{\color{Blue}&space;-sin(\alpha)}&0&0\\{\color{Blue}&space;sin(\alpha)}&{\color{Blue}&space;cos(\alpha)}&0&0\\0&0&1&0\\0&0&0&1\\\end{bmatrix}{\color{Red}*}\begin{bmatrix}x\\y\\z\\1\\\end{bmatrix}" /></p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="nf">RotationZMatrix</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">angle</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">//  |  c -s  0  0  |</span>
<span class="w">    </span><span class="c1">//  |  s  c  0  0  |</span>
<span class="w">    </span><span class="c1">//  |  0  0  1  0  |</span>
<span class="w">    </span><span class="c1">//  |  0  0  0  1  |</span>
<span class="w">    </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">IdentityMatrix</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>La matriz de rotación alrededor del eje <code>X</code>, manteniéndo ese eje intocable (primera fila y primera columna) es:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}1&0&0&0\\0&{\color{Blue}&space;cos(\alpha)}&{\color{Blue}&space;-sin(\alpha)}&0\\0&{\color{Blue}&space;sin(\alpha)}&{\color{Blue}&space;cos(\alpha)}&0\\0&0&0&1\\\end{bmatrix}{\color{Red}*}\begin{bmatrix}x\\y\\z\\1\\\end{bmatrix}"/></p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="nf">RotationXMatrix</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">angle</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">//  |  1  0  0  0  |</span>
<span class="w">    </span><span class="c1">//  |  0  c -s  0  |</span>
<span class="w">    </span><span class="c1">//  |  0  s  c  0  |</span>
<span class="w">    </span><span class="c1">//  |  0  0  0  1  |</span>
<span class="w">    </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">IdentityMatrix</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>La matriz de rotación alrededor del eje <code>Y</code>, manteniéndo ese eje intocable (segunda fila y segunda columna) es:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}{\color{Blue}&space;cos(\alpha)}&0&{\color{Orange}&space;sin(\alpha)}&0\\0&1&0&0\\{\color{Orange}&space;-sin(\alpha)}&0&{\color{Blue}&space;cos(\alpha)}&0\\0&0&0&1\\\end{bmatrix}{\color{Red}*}\begin{bmatrix}x\\y\\z\\1\\\end{bmatrix}"/></p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="nf">RotationYMatrix</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">angle</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">//  |  c  0  s  0  |</span>
<span class="w">    </span><span class="c1">//  |  0  1  0  0  |</span>
<span class="w">    </span><span class="c1">//  | -s  0  c  0  |</span>
<span class="w">    </span><span class="c1">//  |  0  0  0  1  |</span>
<span class="w">    </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">IdentityMatrix</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">m</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Es importante notar que <strong>el signo de los senos está cambiado en todas las matrices</strong>. La notación formal es para cuando <code>Z</code> crece en sentido horario, en nuestro sistema hemos aplicado lo contrario (crece en sentido antihorario), por tanto los senos estás negados.</p>
<p>En cualquier caso aplicaremos esta rotación en el <code>mesh.Update</code>, siempre después del escalado y antes de la traslación. Es muy importante porque sino realizaremos la rotación respecto a la posición trasladada:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/*** Apply transformations for all face vertices ***/</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ORDER MATTERS, REALLY IMPORTANT</span>
<span class="w">    </span><span class="c1">// 1. Scale using the matrix</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ScaleVertex</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// 2. Rotate using the matrices</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">RotateVertex</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">rotation</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// 3. Translation using the matrix</span>
<span class="w">    </span><span class="n">triangles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">TranslateVertex</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">translation</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>El método de rotación de <code>Triangle</code> hará uso de las tres matrices de rotación:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">RotateVertex</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vertexIndex</span><span class="p">,</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">rotation</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Use a matrix to transform rotate the origin vertex</span>
<span class="w">    </span><span class="n">Vector4</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">{</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]};</span><span class="w"></span>
<span class="w">    </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">RotationXMatrix</span><span class="p">(</span><span class="n">rotation</span><span class="p">.</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">RotationYMatrix</span><span class="p">(</span><span class="n">rotation</span><span class="p">.</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">RotationZMatrix</span><span class="p">(</span><span class="n">rotation</span><span class="p">.</span><span class="n">z</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">.</span><span class="n">ToVector3</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>En principio podemos reutilizar lo que teníamos de la interfaz y ya tendremos un visualizador de modelos 3D bastante completo:</p>
<p><img alt="" src="/cdn/graficos3d/anim-19.gif" /></p>
<h2 id="matriz-de-mundo-3d">Matriz de mundo 3D<a class="headerlink" href="#matriz-de-mundo-3d" title="Permanent link">&para;</a></h2>
<p>La matriz de mundo es una combinación de todas las demás transformaciones (escalado, rotación, traslación...) en una sola matriz.</p>
<p>En la práctica es una multiplicación de todas las demás matrices:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}m_{11}&space;&&space;m_{12}&space;&&space;m_{13}&space;&&space;m_{14}&space;\\m_{21}&space;&&space;m_{22}&space;&&space;m_{23}&space;&&space;m_{24}&space;\\m_{31}&space;&&space;m_{32}&space;&&space;m_{33}&space;&&space;m_{34}&space;\\m_{41}&space;&&space;m_{42}&space;&&space;m_{43}&space;&&space;m_{44}&space;\\\end{bmatrix}{\color{Red}&space;*}\begin{bmatrix}m_{11}&space;&&space;m_{12}&space;&&space;m_{13}&space;&&space;m_{14}&space;\\m_{21}&space;&&space;m_{22}&space;&&space;m_{23}&space;&&space;m_{24}&space;\\m_{31}&space;&&space;m_{32}&space;&&space;m_{33}&space;&&space;m_{34}&space;\\m_{41}&space;&&space;m_{42}&space;&&space;m_{43}&space;&&space;m_{44}&space;\\\end{bmatrix}"/></p>
<p>Necesitaremos implementar la multiplicación de dos matrices <code>Matrix4</code> aplicando las reglas de multiplicación sobrecargando operadores: </p>
<div class="highlight"><pre><span></span><code><span class="n">Matrix4</span><span class="w"> </span><span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="n">Matrix4</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">result</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m2</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"></span>
<span class="w">                                </span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m2</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"></span>
<span class="w">                                </span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m2</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"></span>
<span class="w">                                </span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m2</span><span class="p">.</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Como este método para generar la matriz de mundo es global recibirá la escala, ángulo y traslación. </p>
<p>Es extremadamente importante respetar el orden de multiplicación de matrices, recodemos que <code>AxB != BxA</code> y aquí <strong>debemos multiplicar siempre primero por la matriz de transformación</strong>. Por supuesto también debemos respetar el orden: primero escalar, luego rotar y finalmente trasladar:</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">Matrix4</span><span class="w"> </span><span class="nf">WorldMatrix</span><span class="p">(</span><span class="n">Vector3</span><span class="w"> </span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">angle</span><span class="p">,</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">translate</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Matrix4</span><span class="w"> </span><span class="n">worldMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">IdentityMatrix</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* El orden de la multiplicación importa ROTACIOn * MUNDO */</span><span class="w"></span>
<span class="w">    </span><span class="n">worldMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">ScalationMatrix</span><span class="p">(</span><span class="n">scale</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">.</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">worldMatrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">worldMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">RotationXMatrix</span><span class="p">(</span><span class="n">angle</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">worldMatrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">worldMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">RotationYMatrix</span><span class="p">(</span><span class="n">angle</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">worldMatrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">worldMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">RotationZMatrix</span><span class="p">(</span><span class="n">angle</span><span class="p">.</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">worldMatrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">worldMatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">TranslationMatrix</span><span class="p">(</span><span class="n">translate</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">translate</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">translate</span><span class="p">.</span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">worldMatrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">worldMatrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Haremos la llamada de la función desde <code>Triangle</code> en un nuevo método <code>WorldVertex</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">WorldVertex</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vertexIndex</span><span class="p">,</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">angle</span><span class="p">,</span><span class="w"> </span><span class="n">Vector3</span><span class="w"> </span><span class="n">translate</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Use a matrix to world transform the origin vertex</span>
<span class="w">    </span><span class="n">Vector4</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">{</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]};</span><span class="w"></span>
<span class="w">    </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Matrix4</span><span class="o">::</span><span class="n">WorldMatrix</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">angle</span><span class="p">,</span><span class="w"> </span><span class="n">translate</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexIndex</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedVertex</span><span class="p">.</span><span class="n">ToVector3</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Con esto tendremos la matriz de mundo todo en una:</p>
<p><img alt="" src="/cdn/graficos3d/anim-20.gif" /></p>
<h2 id="reflexion-sobre-la-traslacion">Reflexión sobre la traslación<a class="headerlink" href="#reflexion-sobre-la-traslacion" title="Permanent link">&para;</a></h2>
<p>Según lo tratado hasta ahora, la traslación es una transformación un tanto especial, recordemos que es la única que requiere la cuarta columna para multiplicar los valores por la cantidad de traslación:</p>
<p><img src="https://latex.codecogs.com/png.image?\dpi{150}\bg{white}\begin{bmatrix}1&0&0&{\color{Blue}tx}\\0&1&0&{\color{Blue}ty}\\0&0&1&{\color{Blue}tz}\\0&0&0&1\\\end{bmatrix}{\color{Red}*}\begin{bmatrix}x\\y\\z\\1\\\end{bmatrix}" /></p>
<p>La realidad es que <strong>la traslación no es una transformación lineal</strong>, ya que estas deben cumplir:</p>
<ul>
<li>Una transformación lineal debe empezar con una línea.</li>
<li>El resultado de una transformación lineal es una línea.</li>
<li>El origen (centro) de la transformación lineal no puede cambiar.</li>
</ul>
<p>A diferencia del escalado y la rotación, que se realizan respecto al centro del objeto <code>(0,0)</code>, la traslación es una operación que requiere cambiar la posición y por tanto el centro del objeto cambiará.</p>
<p>Para solucionar este problema  lo que hacemos es abstraer el vector a una cuarta dimensión imaginaria (la cuarta columna y fila de la matriz), realizamos los cálculos pertinentes para trasladarlos y una vez lo tenemos transformamos de nuevo al espacio tridimensional 3D.</p>
<hr />
<p><small class="edited"><i>Última edición: 05 de Junio de 2022</i></small></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-nav">
    <nav class="md-footer-nav__inner md-grid">
      
      <a
        href="../15-operaciones-con-matrices/"
        title="Operaciones con matrices"
        class="md-flex md-footer-nav__link md-footer-nav__link--prev"
        rel="prev"
      >
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
        </div>
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Anterior
            </span>
            Operaciones con matrices
          </span>
        </div>
      </a>
       
      <a
        href="../17-matriz-de-proyeccion/"
        title="Matriz de proyección"
        class="md-flex md-footer-nav__link md-footer-nav__link--next"
        rel="next"
      >
        <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
          <span class="md-flex__ellipsis">
            <span class="md-footer-nav__direction">
              Siguiente
            </span>
            Matriz de proyección
          </span>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
        </div>
      </a>
      
    </nav>
  </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <!--<div class="md-footer-links__highlight">
          <a href="/comunidad/">Comunidad</a> · <a href="/politica-de-cookies/">Política de cookies</a> · <a href="/sobre-mi/">Sobre mí</a>
        </div>-->
        <div class="md-footer-copyright__highlight">
          2015 - 2022 &copy; Héctor Costa Guzmán (<u
            ><a
              href="https://creativecommons.org/licenses/by/4.0/deed.es"
              target="_blank"
              rel="nofollow"
              >Licencia CC BY 4.0</a
            ></u
          >)
        </div>
      </div>
       
<style>.md-footer-social__link {transition: 0.3s;}</style>
<div class="md-footer-social" style="font-size: 2.5rem; margin-top: -6px!important; padding: 0px!important; margin-bottom: -6px; overflow: hidden!important;">
  <a href="https://github.com/hcosta" title="Github" target="_blank" class="md-footer-social__link fa fa-github-square"></a>
  <a href="https://www.youtube.com/c/HektorProfe" title="Youtube" target="_blank" class="md-footer-social__link fa fa-youtube-square"></a>
  &nbsp;
</div>
 
    </div>
  </div>
  <script>
    (function (i, s, o, g, r, a, m) {
      i["GoogleAnalyticsObject"] = r;
      (i[r] =
        i[r] ||
        function () {
          (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
      (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m);
    })(
      window,
      document,
      "script",
      "https://www.google-analytics.com/analytics.js",
      "ga"
    );
    ga("create", "UA-124845547-1", "auto");
    ga("send", "pageview");
  </script>
</footer>
      
      <a id="anchorID" href="https://www.hektorprofe.net/" target="_blank"></a>
    </div>
  <script type='text/javascript' src="/assets/javascripts/application.a26c1c21.js"></script>
  <script src="/assets/javascripts/tingle.min.js"></script>
  <script type='text/javascript'>
    var modalButtonOnly = new tingle.modal({
        closeMethods: [],
        footer: true,
        stickyFooter: true
    });
    var btn5 = document.querySelector('.js-tingle-modal-5');

    // set content
    modalButtonOnly.setContent(`
    <div style="display:grid;grid-template-columns:32% 32% 32%;grid-column-gap: 1.33%;" id="supermodal">
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/python" target="_blank"><img src="/cdn/assets/python.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/django" target="_blank"><img src="/cdn/assets/django.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
      <div class="course">
        <a href="https://www.hektorprofe.net/cupon/pyside" target="_blank"><img src="/cdn/assets/pyside.png" style="width:100%;justify-self:center;align-self:center;"/></a>
      </div>
    </div>`);

    modalButtonOnly.addFooterBtn('Cerrar', 'tingle-btn tingle-btn--default tingle-btn--pull-right', function(){
      modalButtonOnly.close();
    });

    app.initialize({version:"1.2.3",url:{base:"../.."}})
    var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoad=e()}(this,function(){"use strict";function t(t,e,n){var o=e._settings;!n&&i(t)||(C(o.callback_enter,t),R.indexOf(t.tagName)>-1&&(N(t,e),I(t,o.class_loading)),E(t,e),a(t),C(o.callback_set,t))}var e={elements_selector:"img",container:document,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,callback_load:null,callback_error:null,callback_set:null,callback_enter:null,callback_finish:null,to_webp:!1},n=function(t){return _extends({},e,t)},o=function(t,e){return t.getAttribute("data-"+e)},r=function(t,e,n){var o="data-"+e;null!==n?t.setAttribute(o,n):t.removeAttribute(o)},a=function(t){return r(t,"was-processed","true")},i=function(t){return"true"===o(t,"was-processed")},s=function(t,e){return r(t,"ll-timeout",e)},c=function(t){return o(t,"ll-timeout")},l=function(t){return t.filter(function(t){return!i(t)})},u=function(t,e){return t.filter(function(t){return t!==e})},d=function(t,e){var n,o=new t(e);try{n=new CustomEvent("LazyLoad::Initialized",{detail:{instance:o}})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:o})}window.dispatchEvent(n)},f=function(t,e){return e?t.replace(/\.(jpe?g|png)/gi,".webp"):t},_="undefined"!=typeof window,v=_&&!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),g=_&&"IntersectionObserver"in window,h=_&&"classList"in document.createElement("p"),b=_&&function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),m=function(t,e,n,r){for(var a,i=0;a=t.children[i];i+=1)if("SOURCE"===a.tagName){var s=o(a,n);p(a,e,s,r)}},p=function(t,e,n,o){n&&t.setAttribute(e,f(n,o))},y=function(t,e){var n=b&&e.to_webp,r=o(t,e.data_src),a=o(t,e.data_bg);if(r){var i=f(r,n);t.style.backgroundImage='url("'+i+'")'}if(a){var s=f(a,n);t.style.backgroundImage=s}},w={IMG:function(t,e){var n=b&&e.to_webp,r=e.data_srcset,a=t.parentNode;a&&"PICTURE"===a.tagName&&m(a,"srcset",r,n);var i=o(t,e.data_sizes);p(t,"sizes",i);var s=o(t,r);p(t,"srcset",s,n);var c=o(t,e.data_src);p(t,"src",c,n)},IFRAME:function(t,e){var n=o(t,e.data_src);p(t,"src",n)},VIDEO:function(t,e){var n=e.data_src,r=o(t,n);m(t,"src",n),p(t,"src",r),t.load()}},E=function(t,e){var n=e._settings,o=t.tagName,r=w[o];if(r)return r(t,n),e._updateLoadingCount(1),void(e._elements=u(e._elements,t));y(t,n)},I=function(t,e){h?t.classList.add(e):t.className+=(t.className?" ":"")+e},L=function(t,e){h?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},C=function(t,e){t&&t(e)},O=function(t,e,n){t.addEventListener(e,n)},k=function(t,e,n){t.removeEventListener(e,n)},x=function(t,e,n){O(t,"load",e),O(t,"loadeddata",e),O(t,"error",n)},A=function(t,e,n){k(t,"load",e),k(t,"loadeddata",e),k(t,"error",n)},z=function(t,e,n){var o=n._settings,r=e?o.class_loaded:o.class_error,a=e?o.callback_load:o.callback_error,i=t.target;L(i,o.class_loading),I(i,r),C(a,i),n._updateLoadingCount(-1)},N=function(t,e){var n=function n(r){z(r,!0,e),A(t,n,o)},o=function o(r){z(r,!1,e),A(t,n,o)};x(t,n,o)},R=["IMG","IFRAME","VIDEO"],S=function(e,n,o){t(e,o),n.unobserve(e)},M=function(t){var e=c(t);e&&(clearTimeout(e),s(t,null))},j=function(t,e,n){var o=n._settings.load_delay,r=c(t);r||(r=setTimeout(function(){S(t,e,n),M(t)},o),s(t,r))},D=function(t){return t.isIntersecting||t.intersectionRatio>0},T=function(t){return{root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}},U=function(t,e){this._settings=n(t),this._setObserver(),this._loadingCount=0,this.update(e)};return U.prototype={_manageIntersection:function(t){var e=this._observer,n=this._settings.load_delay,o=t.target;n?D(t)?j(o,e,this):M(o):D(t)&&S(o,e,this)},_onIntersection:function(t){t.forEach(this._manageIntersection.bind(this))},_setObserver:function(){g&&(this._observer=new IntersectionObserver(this._onIntersection.bind(this),T(this._settings)))},_updateLoadingCount:function(t){this._loadingCount+=t,0===this._elements.length&&0===this._loadingCount&&C(this._settings.callback_finish)},update:function(t){var e=this,n=this._settings,o=t||n.container.querySelectorAll(n.elements_selector);this._elements=l(Array.prototype.slice.call(o)),!v&&this._observer?this._elements.forEach(function(t){e._observer.observe(t)}):this.loadAll()},destroy:function(){var t=this;this._observer&&(this._elements.forEach(function(e){t._observer.unobserve(e)}),this._observer=null),this._elements=null,this._settings=null},load:function(e,n){t(e,this,n)},loadAll:function(){var t=this;this._elements.forEach(function(e){t.load(e)})}},_&&function(t,e){if(e)if(e.length)for(var n,o=0;n=e[o];o+=1)d(t,n);else d(t,e)}(U,window.lazyLoadOptions),U});
    var myLazyLoad = new LazyLoad({elements_selector: ".lazy"});
    const mdMenuItems = document.querySelectorAll('.md-nav__link');
    function doNav(){ document.getElementById("main__list").innerHTML = '<li class="md-nav__item"><a class="md-nav__link" href="/cursos/">Cursos</a></li><li class="md-nav__item"><a class="md-nav__link" href="/blog/">Blog</a></li>';}
    for (i = 0; i < mdMenuItems.length; i++) {  var item = mdMenuItems[i]; var htmlstring = item.innerHTML; htmlstring = (htmlstring.trim) ? htmlstring.trim() : htmlstring.replace(/^\s+/,''); if (htmlstring == 'Servidor de encuentro') { item.parentNode.removeChild(item);continue; }  if (htmlstring == 'Política de Cookies') { item.parentNode.removeChild(item);continue; } if (htmlstring == 'Buscador') { item.parentNode.removeChild(item); continue; } }
    try { var topPos = document.querySelector('#md__active_link').offsetTop; document.querySelector('#md__sidebar__scroll').scrollTop = topPos - 60; } catch (err) {}
  </script>
  </body>
</html>